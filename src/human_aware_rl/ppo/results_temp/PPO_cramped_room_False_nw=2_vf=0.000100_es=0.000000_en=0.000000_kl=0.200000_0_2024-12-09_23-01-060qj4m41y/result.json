{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 11.5, "shaped_reward_min": 6, "shaped_reward_max": 17, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 6.0, "onion_pickup_agent_0_min": 4, "onion_pickup_agent_0_max": 8, "onion_pickup_agent_1_mean": 6.0, "onion_pickup_agent_1_min": 5, "onion_pickup_agent_1_max": 7, "useful_onion_pickup_agent_0_mean": 3.5, "useful_onion_pickup_agent_0_min": 3, "useful_onion_pickup_agent_0_max": 4, "useful_onion_pickup_agent_1_mean": 4.0, "useful_onion_pickup_agent_1_min": 3, "useful_onion_pickup_agent_1_max": 5, "onion_drop_agent_0_mean": 3.0, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 5, "onion_drop_agent_1_mean": 4.0, "onion_drop_agent_1_min": 2, "onion_drop_agent_1_max": 6, "useful_onion_drop_agent_0_mean": 2.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 4, "useful_onion_drop_agent_1_mean": 2.5, "useful_onion_drop_agent_1_min": 1, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 2.0, "potting_onion_agent_0_min": 2, "potting_onion_agent_0_max": 2, "potting_onion_agent_1_mean": 1.0, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 2.5, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 5, "dish_pickup_agent_1_mean": 1.5, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 3, "useful_dish_pickup_agent_0_mean": 0.0, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 0, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 2.0, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 4, "dish_drop_agent_1_mean": 1.5, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 3, "useful_dish_drop_agent_0_mean": 1.0, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 2, "useful_dish_drop_agent_1_mean": 0.5, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 1, "soup_pickup_agent_0_mean": 0.5, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 1, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.5, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 1, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 2.0, "optimal_onion_potting_agent_0_min": 2, "optimal_onion_potting_agent_0_max": 2, "optimal_onion_potting_agent_1_mean": 1.0, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 2.0, "viable_onion_potting_agent_0_min": 2, "viable_onion_potting_agent_0_max": 2, "viable_onion_potting_agent_1_mean": 1.0, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 4.469044506549835e-05, "policy_loss": -3.5293400287628174e-05, "vf_loss": 0.798213541507721, "vf_explained_var": 0.004208415746688843, "kl": 8.205651624848542e-07, "entropy": 1.7903311252593994, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 800, "num_env_steps_trained": 800, "num_agent_steps_sampled": 1600, "num_agent_steps_trained": 1600}, "sampler_results": {"episode_reward_max": 17.0, "episode_reward_min": 6.0, "episode_reward_mean": 11.5, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.0}, "policy_reward_mean": {"ppo": 5.75}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 11.5, "shaped_reward_min": 6, "shaped_reward_max": 17, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 6.0, "onion_pickup_agent_0_min": 4, "onion_pickup_agent_0_max": 8, "onion_pickup_agent_1_mean": 6.0, "onion_pickup_agent_1_min": 5, "onion_pickup_agent_1_max": 7, "useful_onion_pickup_agent_0_mean": 3.5, "useful_onion_pickup_agent_0_min": 3, "useful_onion_pickup_agent_0_max": 4, "useful_onion_pickup_agent_1_mean": 4.0, "useful_onion_pickup_agent_1_min": 3, "useful_onion_pickup_agent_1_max": 5, "onion_drop_agent_0_mean": 3.0, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 5, "onion_drop_agent_1_mean": 4.0, "onion_drop_agent_1_min": 2, "onion_drop_agent_1_max": 6, "useful_onion_drop_agent_0_mean": 2.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 4, "useful_onion_drop_agent_1_mean": 2.5, "useful_onion_drop_agent_1_min": 1, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 2.0, "potting_onion_agent_0_min": 2, "potting_onion_agent_0_max": 2, "potting_onion_agent_1_mean": 1.0, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 2.5, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 5, "dish_pickup_agent_1_mean": 1.5, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 3, "useful_dish_pickup_agent_0_mean": 0.0, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 0, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 2.0, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 4, "dish_drop_agent_1_mean": 1.5, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 3, "useful_dish_drop_agent_0_mean": 1.0, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 2, "useful_dish_drop_agent_1_mean": 0.5, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 1, "soup_pickup_agent_0_mean": 0.5, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 1, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.5, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 1, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 2.0, "optimal_onion_potting_agent_0_min": 2, "optimal_onion_potting_agent_0_max": 2, "optimal_onion_potting_agent_1_mean": 1.0, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 2.0, "viable_onion_potting_agent_0_min": 2, "viable_onion_potting_agent_0_max": 2, "viable_onion_potting_agent_1_mean": 1.0, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0], "episode_lengths": [400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3771680846178621, "mean_inference_ms": 1.7952835767940987, "mean_action_processing_ms": 0.10597913937081126, "mean_env_wait_ms": 0.492581108264495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 17.0, "episode_reward_min": 6.0, "episode_reward_mean": 11.5, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.0}, "policy_reward_mean": {"ppo": 5.75}, "hist_stats": {"episode_reward": [17.0, 6.0], "episode_lengths": [400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3771680846178621, "mean_inference_ms": 1.7952835767940987, "mean_action_processing_ms": 0.10597913937081126, "mean_env_wait_ms": 0.492581108264495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 1600, "num_agent_steps_trained": 1600, "num_env_steps_sampled": 800, "num_env_steps_trained": 800, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 800, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 1600, "timers": {"training_iteration_time_ms": 1309.981, "learn_time_ms": 161.963, "learn_throughput": 4939.393, "synch_weights_time_ms": 13.359}, "counters": {"num_env_steps_sampled": 800, "num_env_steps_trained": 800, "num_agent_steps_sampled": 1600, "num_agent_steps_trained": 1600}, "done": false, "episodes_total": 2, "training_iteration": 1, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-02-54", "timestamp": 1733745774, "time_this_iter_s": 1.3137538433074951, "time_total_s": 1.3137538433074951, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 1.3137538433074951, "timesteps_since_restore": 0, "iterations_since_restore": 1, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 21.1, "ram_util_percent": 75.7}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.75, "shaped_reward_min": 6, "shaped_reward_max": 17, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.75, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 8, "onion_pickup_agent_1_mean": 5.25, "onion_pickup_agent_1_min": 4, "onion_pickup_agent_1_max": 7, "useful_onion_pickup_agent_0_mean": 2.25, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 4, "useful_onion_pickup_agent_1_mean": 3.75, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 5, "onion_drop_agent_0_mean": 3.0, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 6, "onion_drop_agent_1_mean": 3.5, "onion_drop_agent_1_min": 2, "onion_drop_agent_1_max": 6, "useful_onion_drop_agent_0_mean": 2.5, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.75, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 2, "potting_onion_agent_1_mean": 1.0, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 3.25, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 6, "dish_pickup_agent_1_mean": 2.25, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 3, "useful_dish_pickup_agent_0_mean": 0.0, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 0, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 2.5, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 5, "dish_drop_agent_1_mean": 2.0, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 3, "useful_dish_drop_agent_0_mean": 1.25, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 3, "useful_dish_drop_agent_1_mean": 0.75, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 2, "soup_pickup_agent_0_mean": 0.5, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 1, "soup_pickup_agent_1_mean": 0.25, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 1, "soup_delivery_agent_0_mean": 0.25, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.25, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 1, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 2, "optimal_onion_potting_agent_1_mean": 1.0, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 2, "viable_onion_potting_agent_1_mean": 1.0, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": -8.480390533804893e-06, "policy_loss": -6.594788283109665e-05, "vf_loss": 0.5743855237960815, "vf_explained_var": -0.001412034034729004, "kl": 3.6674293824034976e-07, "entropy": 1.7904002666473389, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1600, "num_env_steps_trained": 1600, "num_agent_steps_sampled": 3200, "num_agent_steps_trained": 3200}, "sampler_results": {"episode_reward_max": 17.0, "episode_reward_min": 6.0, "episode_reward_mean": 9.75, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.0}, "policy_reward_mean": {"ppo": 4.875}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.75, "shaped_reward_min": 6, "shaped_reward_max": 17, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.75, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 8, "onion_pickup_agent_1_mean": 5.25, "onion_pickup_agent_1_min": 4, "onion_pickup_agent_1_max": 7, "useful_onion_pickup_agent_0_mean": 2.25, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 4, "useful_onion_pickup_agent_1_mean": 3.75, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 5, "onion_drop_agent_0_mean": 3.0, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 6, "onion_drop_agent_1_mean": 3.5, "onion_drop_agent_1_min": 2, "onion_drop_agent_1_max": 6, "useful_onion_drop_agent_0_mean": 2.5, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.75, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 2, "potting_onion_agent_1_mean": 1.0, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 3.25, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 6, "dish_pickup_agent_1_mean": 2.25, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 3, "useful_dish_pickup_agent_0_mean": 0.0, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 0, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 2.5, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 5, "dish_drop_agent_1_mean": 2.0, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 3, "useful_dish_drop_agent_0_mean": 1.25, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 3, "useful_dish_drop_agent_1_mean": 0.75, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 2, "soup_pickup_agent_0_mean": 0.5, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 1, "soup_pickup_agent_1_mean": 0.25, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 1, "soup_delivery_agent_0_mean": 0.25, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.25, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 1, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 2, "optimal_onion_potting_agent_1_mean": 1.0, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 2, "viable_onion_potting_agent_1_mean": 1.0, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0], "episode_lengths": [400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36548936298486073, "mean_inference_ms": 1.817376728943778, "mean_action_processing_ms": 0.10282188040365149, "mean_env_wait_ms": 0.48142931510257386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 17.0, "episode_reward_min": 6.0, "episode_reward_mean": 9.75, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.0}, "policy_reward_mean": {"ppo": 4.875}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0], "episode_lengths": [400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36548936298486073, "mean_inference_ms": 1.817376728943778, "mean_action_processing_ms": 0.10282188040365149, "mean_env_wait_ms": 0.48142931510257386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 3200, "num_agent_steps_trained": 3200, "num_env_steps_sampled": 1600, "num_env_steps_trained": 1600, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 1600, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 3200, "timers": {"training_iteration_time_ms": 1221.717, "learn_time_ms": 87.561, "learn_throughput": 9136.474, "synch_weights_time_ms": 7.679}, "counters": {"num_env_steps_sampled": 1600, "num_env_steps_trained": 1600, "num_agent_steps_sampled": 3200, "num_agent_steps_trained": 3200}, "done": false, "episodes_total": 4, "training_iteration": 2, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-02-55", "timestamp": 1733745775, "time_this_iter_s": 1.1409814357757568, "time_total_s": 2.454735279083252, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 2.454735279083252, "timesteps_since_restore": 0, "iterations_since_restore": 2, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 21.45, "ram_util_percent": 75.75}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.833333333333334, "shaped_reward_min": 3, "shaped_reward_max": 17, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.5, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 8, "onion_pickup_agent_1_mean": 6.5, "onion_pickup_agent_1_min": 4, "onion_pickup_agent_1_max": 11, "useful_onion_pickup_agent_0_mean": 2.3333333333333335, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 5, "useful_onion_pickup_agent_1_mean": 4.666666666666667, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 2.6666666666666665, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 6, "onion_drop_agent_1_mean": 4.833333333333333, "onion_drop_agent_1_min": 2, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.8333333333333333, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 2.1666666666666665, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 2, "potting_onion_agent_1_mean": 0.8333333333333334, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 2.3333333333333335, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 6, "dish_pickup_agent_1_mean": 1.8333333333333333, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 3, "useful_dish_pickup_agent_0_mean": 0.0, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 0, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 1.8333333333333333, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 5, "dish_drop_agent_1_mean": 1.5, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 3, "useful_dish_drop_agent_0_mean": 0.8333333333333334, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 3, "useful_dish_drop_agent_1_mean": 0.6666666666666666, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 2, "soup_pickup_agent_0_mean": 0.3333333333333333, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 1, "soup_pickup_agent_1_mean": 0.3333333333333333, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 1, "soup_delivery_agent_0_mean": 0.16666666666666666, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.16666666666666666, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 1, "soup_drop_agent_1_mean": 0.16666666666666666, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 1, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 2, "optimal_onion_potting_agent_1_mean": 0.8333333333333334, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 2, "viable_onion_potting_agent_1_mean": 0.8333333333333334, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": -2.3633241653442383e-05, "policy_loss": -7.588788866996765e-05, "vf_loss": 0.5222504734992981, "vf_explained_var": -0.004339933395385742, "kl": 6.078255410102429e-07, "entropy": 1.790407419204712, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 2400, "num_env_steps_trained": 2400, "num_agent_steps_sampled": 4800, "num_agent_steps_trained": 4800}, "sampler_results": {"episode_reward_max": 17.0, "episode_reward_min": 3.0, "episode_reward_mean": 8.833333333333334, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.0}, "policy_reward_mean": {"ppo": 4.416666666666667}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.833333333333334, "shaped_reward_min": 3, "shaped_reward_max": 17, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.5, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 8, "onion_pickup_agent_1_mean": 6.5, "onion_pickup_agent_1_min": 4, "onion_pickup_agent_1_max": 11, "useful_onion_pickup_agent_0_mean": 2.3333333333333335, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 5, "useful_onion_pickup_agent_1_mean": 4.666666666666667, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 2.6666666666666665, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 6, "onion_drop_agent_1_mean": 4.833333333333333, "onion_drop_agent_1_min": 2, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.8333333333333333, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 2.1666666666666665, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 2, "potting_onion_agent_1_mean": 0.8333333333333334, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 2.3333333333333335, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 6, "dish_pickup_agent_1_mean": 1.8333333333333333, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 3, "useful_dish_pickup_agent_0_mean": 0.0, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 0, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 1.8333333333333333, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 5, "dish_drop_agent_1_mean": 1.5, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 3, "useful_dish_drop_agent_0_mean": 0.8333333333333334, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 3, "useful_dish_drop_agent_1_mean": 0.6666666666666666, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 2, "soup_pickup_agent_0_mean": 0.3333333333333333, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 1, "soup_pickup_agent_1_mean": 0.3333333333333333, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 1, "soup_delivery_agent_0_mean": 0.16666666666666666, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.16666666666666666, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 1, "soup_drop_agent_1_mean": 0.16666666666666666, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 1, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 2, "optimal_onion_potting_agent_1_mean": 0.8333333333333334, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 2, "viable_onion_potting_agent_1_mean": 0.8333333333333334, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0], "episode_lengths": [400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3718625655542105, "mean_inference_ms": 1.8134722881627727, "mean_action_processing_ms": 0.09601767121263032, "mean_env_wait_ms": 0.4729273176132935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 17.0, "episode_reward_min": 3.0, "episode_reward_mean": 8.833333333333334, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 11.0}, "policy_reward_mean": {"ppo": 4.416666666666667}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0], "episode_lengths": [400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3718625655542105, "mean_inference_ms": 1.8134722881627727, "mean_action_processing_ms": 0.09601767121263032, "mean_env_wait_ms": 0.4729273176132935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 4800, "num_agent_steps_trained": 4800, "num_env_steps_sampled": 2400, "num_env_steps_trained": 2400, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 2400, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 4800, "timers": {"training_iteration_time_ms": 1177.84, "learn_time_ms": 62.572, "learn_throughput": 12785.238, "synch_weights_time_ms": 6.193}, "counters": {"num_env_steps_sampled": 2400, "num_env_steps_trained": 2400, "num_agent_steps_sampled": 4800, "num_agent_steps_trained": 4800}, "done": false, "episodes_total": 6, "training_iteration": 3, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-02-56", "timestamp": 1733745776, "time_this_iter_s": 1.096334457397461, "time_total_s": 3.551069736480713, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 3.551069736480713, "timesteps_since_restore": 0, "iterations_since_restore": 3, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 34.2, "ram_util_percent": 75.95}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 10.5, "shaped_reward_min": 3, "shaped_reward_max": 22, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.5, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 8, "onion_pickup_agent_1_mean": 7.0, "onion_pickup_agent_1_min": 4, "onion_pickup_agent_1_max": 11, "useful_onion_pickup_agent_0_mean": 2.375, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 5, "useful_onion_pickup_agent_1_mean": 5.125, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 2.75, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 6, "onion_drop_agent_1_mean": 5.0, "onion_drop_agent_1_min": 2, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.875, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.875, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 1.125, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 1.125, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 3.125, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 6, "dish_pickup_agent_1_mean": 1.75, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 3, "useful_dish_pickup_agent_0_mean": 0.0, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 0, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 2.5, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 6, "dish_drop_agent_1_mean": 1.5, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 3, "useful_dish_drop_agent_0_mean": 1.0, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 3, "useful_dish_drop_agent_1_mean": 0.875, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 3, "soup_pickup_agent_0_mean": 0.75, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.25, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 1, "soup_delivery_agent_0_mean": 0.125, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.5, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.125, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 1, "optimal_onion_potting_agent_0_mean": 1.125, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 1.125, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.125, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 1.125, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0001339837908744812, "policy_loss": 2.11130827665329e-06, "vf_loss": 1.3185901641845703, "vf_explained_var": 0.006074368953704834, "kl": 6.42055624666682e-07, "entropy": 1.7904444932937622, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 3200, "num_env_steps_trained": 3200, "num_agent_steps_sampled": 6400, "num_agent_steps_trained": 6400}, "sampler_results": {"episode_reward_max": 22.0, "episode_reward_min": 3.0, "episode_reward_mean": 10.5, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 19.0}, "policy_reward_mean": {"ppo": 5.25}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 10.5, "shaped_reward_min": 3, "shaped_reward_max": 22, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.5, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 8, "onion_pickup_agent_1_mean": 7.0, "onion_pickup_agent_1_min": 4, "onion_pickup_agent_1_max": 11, "useful_onion_pickup_agent_0_mean": 2.375, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 5, "useful_onion_pickup_agent_1_mean": 5.125, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 2.75, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 6, "onion_drop_agent_1_mean": 5.0, "onion_drop_agent_1_min": 2, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.875, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.875, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 1.125, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 1.125, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 3.125, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 6, "dish_pickup_agent_1_mean": 1.75, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 3, "useful_dish_pickup_agent_0_mean": 0.0, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 0, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 2.5, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 6, "dish_drop_agent_1_mean": 1.5, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 3, "useful_dish_drop_agent_0_mean": 1.0, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 3, "useful_dish_drop_agent_1_mean": 0.875, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 3, "soup_pickup_agent_0_mean": 0.75, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.25, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 1, "soup_delivery_agent_0_mean": 0.125, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.5, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.125, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 1, "optimal_onion_potting_agent_0_mean": 1.125, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 1.125, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.125, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 1.125, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3757723607650272, "mean_inference_ms": 1.8003319111130107, "mean_action_processing_ms": 0.09359130755164974, "mean_env_wait_ms": 0.4659222229169846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 22.0, "episode_reward_min": 3.0, "episode_reward_mean": 10.5, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 19.0}, "policy_reward_mean": {"ppo": 5.25}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3757723607650272, "mean_inference_ms": 1.8003319111130107, "mean_action_processing_ms": 0.09359130755164974, "mean_env_wait_ms": 0.4659222229169846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 6400, "num_agent_steps_trained": 6400, "num_env_steps_sampled": 3200, "num_env_steps_trained": 3200, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 3200, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 6400, "timers": {"training_iteration_time_ms": 1144.145, "learn_time_ms": 52.56, "learn_throughput": 15220.622, "synch_weights_time_ms": 4.645}, "counters": {"num_env_steps_sampled": 3200, "num_env_steps_trained": 3200, "num_agent_steps_sampled": 6400, "num_agent_steps_trained": 6400}, "done": false, "episodes_total": 8, "training_iteration": 4, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-02-58", "timestamp": 1733745778, "time_this_iter_s": 1.0565450191497803, "time_total_s": 4.607614755630493, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 4.607614755630493, "timesteps_since_restore": 0, "iterations_since_restore": 4, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 30.9, "ram_util_percent": 75.9}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 10.1, "shaped_reward_min": 3, "shaped_reward_max": 22, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.0, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 8, "onion_pickup_agent_1_mean": 6.4, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 11, "useful_onion_pickup_agent_0_mean": 2.7, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 5, "useful_onion_pickup_agent_1_mean": 4.8, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.1, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 6, "onion_drop_agent_1_mean": 4.6, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.9, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.5, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 1.2, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.9, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 3.3, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 6, "dish_pickup_agent_1_mean": 1.7, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 3, "useful_dish_pickup_agent_0_mean": 0.0, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 0, "useful_dish_pickup_agent_1_mean": 0.1, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.7, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 6, "dish_drop_agent_1_mean": 1.5, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 3, "useful_dish_drop_agent_0_mean": 1.5, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.9, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 3, "soup_pickup_agent_0_mean": 0.7, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.2, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 1, "soup_delivery_agent_0_mean": 0.2, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.4, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.1, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 1, "optimal_onion_potting_agent_0_mean": 1.2, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.9, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.2, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.9, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 6.119534373283386e-05, "policy_loss": 6.873160600662231e-07, "vf_loss": 0.6049899458885193, "vf_explained_var": -0.001478731632232666, "kl": 5.24140773450199e-07, "entropy": 1.7904937267303467, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 22.0, "episode_reward_min": 3.0, "episode_reward_mean": 10.1, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 19.0}, "policy_reward_mean": {"ppo": 5.05}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 10.1, "shaped_reward_min": 3, "shaped_reward_max": 22, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.0, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 8, "onion_pickup_agent_1_mean": 6.4, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 11, "useful_onion_pickup_agent_0_mean": 2.7, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 5, "useful_onion_pickup_agent_1_mean": 4.8, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.1, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 6, "onion_drop_agent_1_mean": 4.6, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.9, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.5, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 1.2, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.9, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 3.3, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 6, "dish_pickup_agent_1_mean": 1.7, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 3, "useful_dish_pickup_agent_0_mean": 0.0, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 0, "useful_dish_pickup_agent_1_mean": 0.1, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.7, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 6, "dish_drop_agent_1_mean": 1.5, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 3, "useful_dish_drop_agent_0_mean": 1.5, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.9, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 3, "soup_pickup_agent_0_mean": 0.7, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.2, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 1, "soup_delivery_agent_0_mean": 0.2, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.4, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.1, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 1, "optimal_onion_potting_agent_0_mean": 1.2, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.9, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.2, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.9, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3817924087928798, "mean_inference_ms": 1.7880867326150232, "mean_action_processing_ms": 0.09067135692692313, "mean_env_wait_ms": 0.4593516259698586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 22.0, "episode_reward_min": 3.0, "episode_reward_mean": 10.1, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 19.0}, "policy_reward_mean": {"ppo": 5.05}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3817924087928798, "mean_inference_ms": 1.7880867326150232, "mean_action_processing_ms": 0.09067135692692313, "mean_env_wait_ms": 0.4593516259698586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 4000, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 1127.447, "learn_time_ms": 46.249, "learn_throughput": 17297.65, "synch_weights_time_ms": 4.115}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 10, "training_iteration": 5, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-02-59", "timestamp": 1733745779, "time_this_iter_s": 1.0684189796447754, "time_total_s": 5.6760337352752686, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 5.6760337352752686, "timesteps_since_restore": 0, "iterations_since_restore": 5, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 26.95, "ram_util_percent": 75.9}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.166666666666666, "shaped_reward_min": 3, "shaped_reward_max": 22, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.75, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 8, "onion_pickup_agent_1_mean": 6.833333333333333, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 2.5, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 5, "useful_onion_pickup_agent_1_mean": 4.833333333333333, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 2.9166666666666665, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 6, "onion_drop_agent_1_mean": 5.0, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.75, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.8333333333333333, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 1.0833333333333333, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.9166666666666666, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.9166666666666665, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 6, "dish_pickup_agent_1_mean": 1.4166666666666667, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 3, "useful_dish_pickup_agent_0_mean": 0.0, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 0, "useful_dish_pickup_agent_1_mean": 0.08333333333333333, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.4166666666666665, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 6, "dish_drop_agent_1_mean": 1.25, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 3, "useful_dish_drop_agent_0_mean": 1.25, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.75, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 3, "soup_pickup_agent_0_mean": 0.5833333333333334, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.16666666666666666, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 1, "soup_delivery_agent_0_mean": 0.16666666666666666, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.3333333333333333, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.08333333333333333, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 1, "optimal_onion_potting_agent_0_mean": 1.0833333333333333, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.9166666666666666, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0833333333333333, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.9166666666666666, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": -1.7121434211730957e-05, "policy_loss": -4.640873521566391e-05, "vf_loss": 0.2928667664527893, "vf_explained_var": 0.009744584560394287, "kl": 2.9626022524098516e-07, "entropy": 1.7903883457183838, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 4800, "num_env_steps_trained": 4800, "num_agent_steps_sampled": 9600, "num_agent_steps_trained": 9600}, "sampler_results": {"episode_reward_max": 22.0, "episode_reward_min": 3.0, "episode_reward_mean": 9.166666666666666, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 19.0}, "policy_reward_mean": {"ppo": 4.583333333333333}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.166666666666666, "shaped_reward_min": 3, "shaped_reward_max": 22, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.75, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 8, "onion_pickup_agent_1_mean": 6.833333333333333, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 2.5, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 5, "useful_onion_pickup_agent_1_mean": 4.833333333333333, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 2.9166666666666665, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 6, "onion_drop_agent_1_mean": 5.0, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.75, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.8333333333333333, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 1.0833333333333333, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.9166666666666666, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.9166666666666665, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 6, "dish_pickup_agent_1_mean": 1.4166666666666667, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 3, "useful_dish_pickup_agent_0_mean": 0.0, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 0, "useful_dish_pickup_agent_1_mean": 0.08333333333333333, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.4166666666666665, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 6, "dish_drop_agent_1_mean": 1.25, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 3, "useful_dish_drop_agent_0_mean": 1.25, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.75, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 3, "soup_pickup_agent_0_mean": 0.5833333333333334, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.16666666666666666, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 1, "soup_delivery_agent_0_mean": 0.16666666666666666, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.3333333333333333, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.08333333333333333, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 1, "optimal_onion_potting_agent_0_mean": 1.0833333333333333, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.9166666666666666, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0833333333333333, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.9166666666666666, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38600438629791767, "mean_inference_ms": 1.7786212918779947, "mean_action_processing_ms": 0.08826996634844055, "mean_env_wait_ms": 0.455520436188051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 22.0, "episode_reward_min": 3.0, "episode_reward_mean": 9.166666666666666, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 19.0}, "policy_reward_mean": {"ppo": 4.583333333333333}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38600438629791767, "mean_inference_ms": 1.7786212918779947, "mean_action_processing_ms": 0.08826996634844055, "mean_env_wait_ms": 0.455520436188051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 9600, "num_agent_steps_trained": 9600, "num_env_steps_sampled": 4800, "num_env_steps_trained": 4800, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 4800, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 9600, "timers": {"training_iteration_time_ms": 1118.492, "learn_time_ms": 40.982, "learn_throughput": 19520.894, "synch_weights_time_ms": 3.429}, "counters": {"num_env_steps_sampled": 4800, "num_env_steps_trained": 4800, "num_agent_steps_sampled": 9600, "num_agent_steps_trained": 9600}, "done": false, "episodes_total": 12, "training_iteration": 6, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-03-00", "timestamp": 1733745780, "time_this_iter_s": 1.0836141109466553, "time_total_s": 6.759647846221924, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 6.759647846221924, "timesteps_since_restore": 0, "iterations_since_restore": 6, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 32.1, "ram_util_percent": 76.0}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.071428571428571, "shaped_reward_min": 3, "shaped_reward_max": 22, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.928571428571429, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 6.571428571428571, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 2.5, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 5, "useful_onion_pickup_agent_1_mean": 4.428571428571429, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.142857142857143, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.785714285714286, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.8571428571428572, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 2.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8571428571428571, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.7857142857142856, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 6, "dish_pickup_agent_1_mean": 1.8571428571428572, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.07142857142857142, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.14285714285714285, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.357142857142857, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 6, "dish_drop_agent_1_mean": 1.6428571428571428, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.0714285714285714, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.6428571428571429, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 3, "soup_pickup_agent_0_mean": 0.5, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.2857142857142857, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.14285714285714285, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.2857142857142857, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.21428571428571427, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8571428571428571, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8571428571428571, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 4.213798092678189e-05, "policy_loss": -1.2499396689236164e-05, "vf_loss": 0.5463582277297974, "vf_explained_var": -0.005753517150878906, "kl": 2.625097010877653e-07, "entropy": 1.7904560565948486, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 5600, "num_env_steps_trained": 5600, "num_agent_steps_sampled": 11200, "num_agent_steps_trained": 11200}, "sampler_results": {"episode_reward_max": 22.0, "episode_reward_min": 3.0, "episode_reward_mean": 9.071428571428571, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 19.0}, "policy_reward_mean": {"ppo": 4.535714285714286}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.071428571428571, "shaped_reward_min": 3, "shaped_reward_max": 22, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.928571428571429, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 6.571428571428571, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 2.5, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 5, "useful_onion_pickup_agent_1_mean": 4.428571428571429, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.142857142857143, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.785714285714286, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.8571428571428572, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 2.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8571428571428571, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.7857142857142856, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 6, "dish_pickup_agent_1_mean": 1.8571428571428572, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.07142857142857142, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.14285714285714285, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.357142857142857, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 6, "dish_drop_agent_1_mean": 1.6428571428571428, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.0714285714285714, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.6428571428571429, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 3, "soup_pickup_agent_0_mean": 0.5, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.2857142857142857, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.14285714285714285, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.2857142857142857, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.21428571428571427, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8571428571428571, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8571428571428571, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3885717630190912, "mean_inference_ms": 1.7714254320436431, "mean_action_processing_ms": 0.08701899249930256, "mean_env_wait_ms": 0.4517204169022535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 22.0, "episode_reward_min": 3.0, "episode_reward_mean": 9.071428571428571, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 19.0}, "policy_reward_mean": {"ppo": 4.535714285714286}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3885717630190912, "mean_inference_ms": 1.7714254320436431, "mean_action_processing_ms": 0.08701899249930256, "mean_env_wait_ms": 0.4517204169022535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 11200, "num_agent_steps_trained": 11200, "num_env_steps_sampled": 5600, "num_env_steps_trained": 5600, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 5600, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 11200, "timers": {"training_iteration_time_ms": 1112.077, "learn_time_ms": 37.118, "learn_throughput": 21553.048, "synch_weights_time_ms": 3.225}, "counters": {"num_env_steps_sampled": 5600, "num_env_steps_trained": 5600, "num_agent_steps_sampled": 11200, "num_agent_steps_trained": 11200}, "done": false, "episodes_total": 14, "training_iteration": 7, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-03-01", "timestamp": 1733745781, "time_this_iter_s": 1.0815868377685547, "time_total_s": 7.8412346839904785, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 7.8412346839904785, "timesteps_since_restore": 0, "iterations_since_restore": 7, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 25.0, "ram_util_percent": 76.0}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.5, "shaped_reward_min": 3, "shaped_reward_max": 22, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.0, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 6.125, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 2.6875, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 5, "useful_onion_pickup_agent_1_mean": 4.0, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.125, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.5, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.75, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.9375, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 1.0625, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.75, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.6875, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 6, "dish_pickup_agent_1_mean": 2.1875, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.0625, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.125, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.3125, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 6, "dish_drop_agent_1_mean": 1.9375, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.1875, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.6875, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 3, "soup_pickup_agent_0_mean": 0.4375, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.25, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.125, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.25, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.1875, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0625, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.75, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0625, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.75, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 3.186750109307468e-05, "policy_loss": -1.0031508281826973e-06, "vf_loss": 0.3287045955657959, "vf_explained_var": 0.006253868341445923, "kl": 2.0773963171905052e-07, "entropy": 1.7906017303466797, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 6400, "num_env_steps_trained": 6400, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800}, "sampler_results": {"episode_reward_max": 22.0, "episode_reward_min": 3.0, "episode_reward_mean": 8.5, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 19.0}, "policy_reward_mean": {"ppo": 4.25}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.5, "shaped_reward_min": 3, "shaped_reward_max": 22, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.0, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 6.125, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 2.6875, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 5, "useful_onion_pickup_agent_1_mean": 4.0, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.125, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.5, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.75, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.9375, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 1.0625, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.75, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.6875, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 6, "dish_pickup_agent_1_mean": 2.1875, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.0625, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.125, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.3125, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 6, "dish_drop_agent_1_mean": 1.9375, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.1875, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.6875, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 3, "soup_pickup_agent_0_mean": 0.4375, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.25, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.125, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.25, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.1875, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0625, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.75, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0625, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.75, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3905994455546896, "mean_inference_ms": 1.764072315768209, "mean_action_processing_ms": 0.08589847609826243, "mean_env_wait_ms": 0.449594220370508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 22.0, "episode_reward_min": 3.0, "episode_reward_mean": 8.5, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 19.0}, "policy_reward_mean": {"ppo": 4.25}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3905994455546896, "mean_inference_ms": 1.764072315768209, "mean_action_processing_ms": 0.08589847609826243, "mean_env_wait_ms": 0.449594220370508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800, "num_env_steps_sampled": 6400, "num_env_steps_trained": 6400, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 6400, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 12800, "timers": {"training_iteration_time_ms": 1106.817, "learn_time_ms": 34.353, "learn_throughput": 23287.66, "synch_weights_time_ms": 3.178}, "counters": {"num_env_steps_sampled": 6400, "num_env_steps_trained": 6400, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800}, "done": false, "episodes_total": 16, "training_iteration": 8, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-03-02", "timestamp": 1733745782, "time_this_iter_s": 1.0779991149902344, "time_total_s": 8.919233798980713, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 8.919233798980713, "timesteps_since_restore": 0, "iterations_since_restore": 8, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 31.049999999999997, "ram_util_percent": 76.0}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.5, "shaped_reward_min": 3, "shaped_reward_max": 22, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.833333333333333, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 6.222222222222222, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 2.7222222222222223, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 5, "useful_onion_pickup_agent_1_mean": 4.166666666666667, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.0555555555555554, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.5, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.6111111111111112, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.8333333333333333, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8333333333333334, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.7222222222222223, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 6, "dish_pickup_agent_1_mean": 1.9444444444444444, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.05555555555555555, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.1111111111111111, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.3333333333333335, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 6, "dish_drop_agent_1_mean": 1.7222222222222223, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.2777777777777777, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.6111111111111112, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 3, "soup_pickup_agent_0_mean": 0.4444444444444444, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.2222222222222222, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.1111111111111111, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.2222222222222222, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.16666666666666666, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8333333333333334, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8333333333333334, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 5.4380856454372406e-05, "policy_loss": -5.0640664994716644e-06, "vf_loss": 0.5944691300392151, "vf_explained_var": 0.00041228532791137695, "kl": 1.714986694878462e-07, "entropy": 1.7905113697052002, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 7200, "num_env_steps_trained": 7200, "num_agent_steps_sampled": 14400, "num_agent_steps_trained": 14400}, "sampler_results": {"episode_reward_max": 22.0, "episode_reward_min": 3.0, "episode_reward_mean": 8.5, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 19.0}, "policy_reward_mean": {"ppo": 4.25}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.5, "shaped_reward_min": 3, "shaped_reward_max": 22, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.833333333333333, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 6.222222222222222, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 2.7222222222222223, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 5, "useful_onion_pickup_agent_1_mean": 4.166666666666667, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.0555555555555554, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.5, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.6111111111111112, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.8333333333333333, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8333333333333334, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.7222222222222223, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 6, "dish_pickup_agent_1_mean": 1.9444444444444444, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.05555555555555555, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.1111111111111111, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.3333333333333335, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 6, "dish_drop_agent_1_mean": 1.7222222222222223, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.2777777777777777, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.6111111111111112, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 3, "soup_pickup_agent_0_mean": 0.4444444444444444, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.2222222222222222, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.1111111111111111, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.2222222222222222, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.16666666666666666, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8333333333333334, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8333333333333334, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39213979087834944, "mean_inference_ms": 1.7581353693961195, "mean_action_processing_ms": 0.08505474664482422, "mean_env_wait_ms": 0.44764371710243694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 22.0, "episode_reward_min": 3.0, "episode_reward_mean": 8.5, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 19.0}, "policy_reward_mean": {"ppo": 4.25}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39213979087834944, "mean_inference_ms": 1.7581353693961195, "mean_action_processing_ms": 0.08505474664482422, "mean_env_wait_ms": 0.44764371710243694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 14400, "num_agent_steps_trained": 14400, "num_env_steps_sampled": 7200, "num_env_steps_trained": 7200, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 7200, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 14400, "timers": {"training_iteration_time_ms": 1102.774, "learn_time_ms": 31.923, "learn_throughput": 25060.674, "synch_weights_time_ms": 2.825}, "counters": {"num_env_steps_sampled": 7200, "num_env_steps_trained": 7200, "num_agent_steps_sampled": 14400, "num_agent_steps_trained": 14400}, "done": false, "episodes_total": 18, "training_iteration": 9, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-03-03", "timestamp": 1733745783, "time_this_iter_s": 1.0836570262908936, "time_total_s": 10.002890825271606, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 10.002890825271606, "timesteps_since_restore": 0, "iterations_since_restore": 9, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 29.2, "ram_util_percent": 75.9}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.2, "shaped_reward_min": 3, "shaped_reward_max": 22, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.6, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 6.1, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 2.65, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 5, "useful_onion_pickup_agent_1_mean": 4.2, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 2.9, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.25, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.5, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.65, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 1.0, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 3.0, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 6, "dish_pickup_agent_1_mean": 1.95, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.05, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.1, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.5, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 6, "dish_drop_agent_1_mean": 1.7, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.3, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.55, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 3, "soup_pickup_agent_0_mean": 0.45, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.25, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.15, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.2, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.15, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 1.0, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 1.0, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 0.00014696083962917328, "policy_loss": 2.675829455256462e-05, "vf_loss": 1.2020924091339111, "vf_explained_var": 0.003164440393447876, "kl": 1.9177696231054142e-07, "entropy": 1.7905011177062988, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 22.0, "episode_reward_min": 3.0, "episode_reward_mean": 9.2, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 19.0}, "policy_reward_mean": {"ppo": 4.6}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.2, "shaped_reward_min": 3, "shaped_reward_max": 22, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.6, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 6.1, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 2.65, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 5, "useful_onion_pickup_agent_1_mean": 4.2, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 2.9, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.25, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.5, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.65, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 1.0, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 3.0, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 6, "dish_pickup_agent_1_mean": 1.95, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.05, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.1, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.5, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 6, "dish_drop_agent_1_mean": 1.7, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.3, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.55, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 3, "soup_pickup_agent_0_mean": 0.45, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.25, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.15, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.2, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.15, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 1.0, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 1.0, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3933687684732569, "mean_inference_ms": 1.7534261197592014, "mean_action_processing_ms": 0.08428615449784109, "mean_env_wait_ms": 0.44653298276410025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 22.0, "episode_reward_min": 3.0, "episode_reward_mean": 9.2, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 19.0}, "policy_reward_mean": {"ppo": 4.6}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3933687684732569, "mean_inference_ms": 1.7534261197592014, "mean_action_processing_ms": 0.08428615449784109, "mean_env_wait_ms": 0.44653298276410025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 8000, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 1103.37, "learn_time_ms": 30.203, "learn_throughput": 26487.344, "synch_weights_time_ms": 2.842}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 20, "training_iteration": 10, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-03-06", "timestamp": 1733745786, "time_this_iter_s": 2.5499064922332764, "time_total_s": 12.552797317504883, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 12.552797317504883, "timesteps_since_restore": 0, "iterations_since_restore": 10, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 23.725, "ram_util_percent": 75.9}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.772727272727273, "shaped_reward_min": 3, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.636363636363637, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 6.181818181818182, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 2.727272727272727, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 5, "useful_onion_pickup_agent_1_mean": 4.2727272727272725, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 2.909090909090909, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.409090909090909, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.5, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.6818181818181819, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 1.0454545454545454, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 1.0, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.8636363636363638, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 6, "dish_pickup_agent_1_mean": 2.0454545454545454, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.09090909090909091, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.13636363636363635, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.3636363636363638, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 6, "dish_drop_agent_1_mean": 1.7272727272727273, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.2727272727272727, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.5, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 3, "soup_pickup_agent_0_mean": 0.5, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.2727272727272727, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.18181818181818182, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.22727272727272727, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.13636363636363635, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0454545454545454, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 1.0, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0454545454545454, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 1.0, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 0.00012375926598906517, "policy_loss": -6.5802596509456635e-06, "vf_loss": 1.3034121990203857, "vf_explained_var": -6.318092346191406e-06, "kl": 7.547109959205045e-08, "entropy": 1.7904644012451172, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 8800, "num_env_steps_trained": 8800, "num_agent_steps_sampled": 17600, "num_agent_steps_trained": 17600}, "sampler_results": {"episode_reward_max": 25.0, "episode_reward_min": 3.0, "episode_reward_mean": 9.772727272727273, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 19.0}, "policy_reward_mean": {"ppo": 4.886363636363637}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.772727272727273, "shaped_reward_min": 3, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.636363636363637, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 6.181818181818182, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 2.727272727272727, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 5, "useful_onion_pickup_agent_1_mean": 4.2727272727272725, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 2.909090909090909, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.409090909090909, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.5, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.6818181818181819, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 1.0454545454545454, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 1.0, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.8636363636363638, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 6, "dish_pickup_agent_1_mean": 2.0454545454545454, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.09090909090909091, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.13636363636363635, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.3636363636363638, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 6, "dish_drop_agent_1_mean": 1.7272727272727273, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.2727272727272727, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.5, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 3, "soup_pickup_agent_0_mean": 0.5, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.2727272727272727, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.18181818181818182, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.22727272727272727, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.13636363636363635, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0454545454545454, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 1.0, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0454545454545454, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 1.0, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39407165297892827, "mean_inference_ms": 1.750361723567707, "mean_action_processing_ms": 0.0838456150006831, "mean_env_wait_ms": 0.4455493098522672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 25.0, "episode_reward_min": 3.0, "episode_reward_mean": 9.772727272727273, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 19.0}, "policy_reward_mean": {"ppo": 4.886363636363637}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39407165297892827, "mean_inference_ms": 1.750361723567707, "mean_action_processing_ms": 0.0838456150006831, "mean_env_wait_ms": 0.4455493098522672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 17600, "num_agent_steps_trained": 17600, "num_env_steps_sampled": 8800, "num_env_steps_trained": 8800, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 8800, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 17600, "timers": {"training_iteration_time_ms": 1083.915, "learn_time_ms": 16.83, "learn_throughput": 47534.392, "synch_weights_time_ms": 1.806}, "counters": {"num_env_steps_sampled": 8800, "num_env_steps_trained": 8800, "num_agent_steps_sampled": 17600, "num_agent_steps_trained": 17600}, "done": false, "episodes_total": 22, "training_iteration": 11, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-03-07", "timestamp": 1733745787, "time_this_iter_s": 1.1256000995635986, "time_total_s": 13.678397417068481, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 13.678397417068481, "timesteps_since_restore": 0, "iterations_since_restore": 11, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 27.799999999999997, "ram_util_percent": 75.9}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.541666666666666, "shaped_reward_min": 3, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.75, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 6.0, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 2.9583333333333335, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 8, "useful_onion_pickup_agent_1_mean": 4.208333333333333, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.0833333333333335, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.333333333333333, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.4583333333333333, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.5833333333333333, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.9583333333333334, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.8333333333333335, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 6, "dish_pickup_agent_1_mean": 2.0833333333333335, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.08333333333333333, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.16666666666666666, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.3333333333333335, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 6, "dish_drop_agent_1_mean": 1.7083333333333333, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.25, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.4583333333333333, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 3, "soup_pickup_agent_0_mean": 0.4583333333333333, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.2916666666666667, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.16666666666666666, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.20833333333333334, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.125, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.9583333333333334, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.9583333333333334, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5.574757233262062e-05, "policy_loss": 4.7925859689712524e-06, "vf_loss": 0.5095937252044678, "vf_explained_var": -0.00022590160369873047, "kl": 9.120891775182827e-08, "entropy": 1.7903268337249756, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 9600, "num_env_steps_trained": 9600, "num_agent_steps_sampled": 19200, "num_agent_steps_trained": 19200}, "sampler_results": {"episode_reward_max": 25.0, "episode_reward_min": 3.0, "episode_reward_mean": 9.541666666666666, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 19.0}, "policy_reward_mean": {"ppo": 4.770833333333333}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.541666666666666, "shaped_reward_min": 3, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.75, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 6.0, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 2.9583333333333335, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 8, "useful_onion_pickup_agent_1_mean": 4.208333333333333, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.0833333333333335, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.333333333333333, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.4583333333333333, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.5833333333333333, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.9583333333333334, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.8333333333333335, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 6, "dish_pickup_agent_1_mean": 2.0833333333333335, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.08333333333333333, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.16666666666666666, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.3333333333333335, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 6, "dish_drop_agent_1_mean": 1.7083333333333333, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.25, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.4583333333333333, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 3, "soup_pickup_agent_0_mean": 0.4583333333333333, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.2916666666666667, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.16666666666666666, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.20833333333333334, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.125, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.9583333333333334, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.9583333333333334, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.394637416451099, "mean_inference_ms": 1.7479677956617703, "mean_action_processing_ms": 0.08329708356388567, "mean_env_wait_ms": 0.44419866983776773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 25.0, "episode_reward_min": 3.0, "episode_reward_mean": 9.541666666666666, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 19.0}, "policy_reward_mean": {"ppo": 4.770833333333333}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.394637416451099, "mean_inference_ms": 1.7479677956617703, "mean_action_processing_ms": 0.08329708356388567, "mean_env_wait_ms": 0.44419866983776773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 19200, "num_agent_steps_trained": 19200, "num_env_steps_sampled": 9600, "num_env_steps_trained": 9600, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 9600, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 19200, "timers": {"training_iteration_time_ms": 1077.188, "learn_time_ms": 16.922, "learn_throughput": 47276.81, "synch_weights_time_ms": 1.907}, "counters": {"num_env_steps_sampled": 9600, "num_env_steps_trained": 9600, "num_agent_steps_sampled": 19200, "num_agent_steps_trained": 19200}, "done": false, "episodes_total": 24, "training_iteration": 12, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-03-08", "timestamp": 1733745788, "time_this_iter_s": 1.0780746936798096, "time_total_s": 14.756472110748291, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 14.756472110748291, "timesteps_since_restore": 0, "iterations_since_restore": 12, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 29.5, "ram_util_percent": 75.9}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.653846153846153, "shaped_reward_min": 3, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.6923076923076925, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 6.038461538461538, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.0, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 8, "useful_onion_pickup_agent_1_mean": 4.3076923076923075, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.076923076923077, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.423076923076923, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.3461538461538463, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.5769230769230769, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.9230769230769231, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.8076923076923075, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 6, "dish_pickup_agent_1_mean": 2.0, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.11538461538461539, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.15384615384615385, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.269230769230769, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 6, "dish_drop_agent_1_mean": 1.6153846153846154, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.1923076923076923, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.4230769230769231, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 3, "soup_pickup_agent_0_mean": 0.46153846153846156, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.3076923076923077, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.15384615384615385, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.19230769230769232, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.11538461538461539, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.9230769230769231, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.9230769230769231, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 6.488896906375885e-05, "policy_loss": -2.1142885088920593e-05, "vf_loss": 0.8603359460830688, "vf_explained_var": -0.0012241601943969727, "kl": 5.790400336991297e-08, "entropy": 1.7903766632080078, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 10400, "num_env_steps_trained": 10400, "num_agent_steps_sampled": 20800, "num_agent_steps_trained": 20800}, "sampler_results": {"episode_reward_max": 25.0, "episode_reward_min": 3.0, "episode_reward_mean": 9.653846153846153, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 19.0}, "policy_reward_mean": {"ppo": 4.826923076923077}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.653846153846153, "shaped_reward_min": 3, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.6923076923076925, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 6.038461538461538, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.0, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 8, "useful_onion_pickup_agent_1_mean": 4.3076923076923075, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.076923076923077, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.423076923076923, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.3461538461538463, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.5769230769230769, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.9230769230769231, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.8076923076923075, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 6, "dish_pickup_agent_1_mean": 2.0, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.11538461538461539, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.15384615384615385, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.269230769230769, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 6, "dish_drop_agent_1_mean": 1.6153846153846154, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.1923076923076923, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.4230769230769231, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 3, "soup_pickup_agent_0_mean": 0.46153846153846156, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.3076923076923077, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.15384615384615385, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.19230769230769232, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.11538461538461539, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.9230769230769231, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.9230769230769231, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39514438674431435, "mean_inference_ms": 1.746462483252691, "mean_action_processing_ms": 0.08275186944897038, "mean_env_wait_ms": 0.44270278307310396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 25.0, "episode_reward_min": 3.0, "episode_reward_mean": 9.653846153846153, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 19.0}, "policy_reward_mean": {"ppo": 4.826923076923077}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39514438674431435, "mean_inference_ms": 1.746462483252691, "mean_action_processing_ms": 0.08275186944897038, "mean_env_wait_ms": 0.44270278307310396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 20800, "num_agent_steps_trained": 20800, "num_env_steps_sampled": 10400, "num_env_steps_trained": 10400, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 10400, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 20800, "timers": {"training_iteration_time_ms": 1077.812, "learn_time_ms": 17.32, "learn_throughput": 46190.359, "synch_weights_time_ms": 1.584}, "counters": {"num_env_steps_sampled": 10400, "num_env_steps_trained": 10400, "num_agent_steps_sampled": 20800, "num_agent_steps_trained": 20800}, "done": false, "episodes_total": 26, "training_iteration": 13, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-03-09", "timestamp": 1733745789, "time_this_iter_s": 1.1125667095184326, "time_total_s": 15.869038820266724, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 15.869038820266724, "timesteps_since_restore": 0, "iterations_since_restore": 13, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 29.0, "ram_util_percent": 75.9}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.964285714285714, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.5, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.785714285714286, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 2.9285714285714284, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 8, "useful_onion_pickup_agent_1_mean": 4.178571428571429, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 2.9642857142857144, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.25, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.25, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.4642857142857142, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 0.9285714285714286, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8571428571428571, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.8214285714285716, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 6, "dish_pickup_agent_1_mean": 2.1785714285714284, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.10714285714285714, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.14285714285714285, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.2857142857142856, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 6, "dish_drop_agent_1_mean": 1.7857142857142858, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.2142857142857142, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.6071428571428571, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.42857142857142855, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.2857142857142857, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.14285714285714285, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.17857142857142858, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.10714285714285714, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 0.9285714285714286, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8571428571428571, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9285714285714286, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8571428571428571, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": -1.4276709407567978e-05, "policy_loss": -1.4333520084619522e-05, "vf_loss": 0.0006006088806316257, "vf_explained_var": -0.9873278737068176, "kl": 7.56412390501282e-08, "entropy": 1.7906365394592285, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 11200, "num_env_steps_trained": 11200, "num_agent_steps_sampled": 22400, "num_agent_steps_trained": 22400}, "sampler_results": {"episode_reward_max": 25.0, "episode_reward_min": 0.0, "episode_reward_mean": 8.964285714285714, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 19.0}, "policy_reward_mean": {"ppo": 4.482142857142857}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.964285714285714, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.5, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.785714285714286, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 2.9285714285714284, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 8, "useful_onion_pickup_agent_1_mean": 4.178571428571429, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 2.9642857142857144, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.25, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.25, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.4642857142857142, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 0.9285714285714286, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8571428571428571, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.8214285714285716, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 6, "dish_pickup_agent_1_mean": 2.1785714285714284, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.10714285714285714, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.14285714285714285, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.2857142857142856, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 6, "dish_drop_agent_1_mean": 1.7857142857142858, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.2142857142857142, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.6071428571428571, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.42857142857142855, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.2857142857142857, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.14285714285714285, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.17857142857142858, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.10714285714285714, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 0.9285714285714286, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8571428571428571, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9285714285714286, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8571428571428571, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3954450805265252, "mean_inference_ms": 1.7452422235588323, "mean_action_processing_ms": 0.08214299061875796, "mean_env_wait_ms": 0.44130524401280413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 25.0, "episode_reward_min": 0.0, "episode_reward_mean": 8.964285714285714, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 19.0}, "policy_reward_mean": {"ppo": 4.482142857142857}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3954450805265252, "mean_inference_ms": 1.7452422235588323, "mean_action_processing_ms": 0.08214299061875796, "mean_env_wait_ms": 0.44130524401280413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 22400, "num_agent_steps_trained": 22400, "num_env_steps_sampled": 11200, "num_env_steps_trained": 11200, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 11200, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 22400, "timers": {"training_iteration_time_ms": 1078.866, "learn_time_ms": 16.587, "learn_throughput": 48230.972, "synch_weights_time_ms": 1.885}, "counters": {"num_env_steps_sampled": 11200, "num_env_steps_trained": 11200, "num_agent_steps_sampled": 22400, "num_agent_steps_trained": 22400}, "done": false, "episodes_total": 28, "training_iteration": 14, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-03-10", "timestamp": 1733745790, "time_this_iter_s": 1.0646016597747803, "time_total_s": 16.933640480041504, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 16.933640480041504, "timesteps_since_restore": 0, "iterations_since_restore": 14, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 28.0, "ram_util_percent": 75.9}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.766666666666667, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.633333333333334, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.8, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.1666666666666665, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.3, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.1, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.266666666666667, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.1666666666666667, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.3666666666666667, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 0.9333333333333333, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8666666666666667, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.966666666666667, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.066666666666667, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.1, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.13333333333333333, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.433333333333333, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.7, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.3, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.5666666666666667, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.4, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.26666666666666666, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.13333333333333333, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.16666666666666666, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.1, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 0.9333333333333333, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8666666666666667, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9333333333333333, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8666666666666667, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 1.220703143189894e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 1.5208497643470764e-05, "policy_loss": -2.4397391825914383e-05, "vf_loss": 0.39602673053741455, "vf_explained_var": -0.01255345344543457, "kl": 1.1704577218552004e-07, "entropy": 1.7906458377838135, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 25.0, "episode_reward_min": 0.0, "episode_reward_mean": 8.766666666666667, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 19.0}, "policy_reward_mean": {"ppo": 4.383333333333334}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.766666666666667, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.633333333333334, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.8, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.1666666666666665, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.3, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.1, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.266666666666667, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.1666666666666667, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.3666666666666667, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 0.9333333333333333, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8666666666666667, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.966666666666667, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.066666666666667, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.1, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.13333333333333333, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.433333333333333, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.7, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.3, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.5666666666666667, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.4, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.26666666666666666, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.13333333333333333, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.16666666666666666, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.1, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 0.9333333333333333, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8666666666666667, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9333333333333333, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8666666666666667, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3956857586323126, "mean_inference_ms": 1.74476298218601, "mean_action_processing_ms": 0.08164552686339896, "mean_env_wait_ms": 0.44021197353396657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 25.0, "episode_reward_min": 0.0, "episode_reward_mean": 8.766666666666667, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 19.0}, "policy_reward_mean": {"ppo": 4.383333333333334}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3956857586323126, "mean_inference_ms": 1.74476298218601, "mean_action_processing_ms": 0.08164552686339896, "mean_env_wait_ms": 0.44021197353396657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 12000, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 1088.385, "learn_time_ms": 17.343, "learn_throughput": 46129.081, "synch_weights_time_ms": 1.885}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 30, "training_iteration": 15, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-03-12", "timestamp": 1733745792, "time_this_iter_s": 1.1578385829925537, "time_total_s": 18.091479063034058, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 18.091479063034058, "timesteps_since_restore": 0, "iterations_since_restore": 15, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 32.9, "ram_util_percent": 75.9}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.9375, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.75, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.6875, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.34375, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.28125, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.1875, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.15625, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.09375, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.28125, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 0.96875, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.875, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.96875, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.125, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.09375, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.15625, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.4375, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.71875, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.3125, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.5625, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.375, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.28125, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.125, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.03125, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.15625, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.09375, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 0.96875, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.875, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.96875, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.875, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 6.10351571594947e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 6.693415343761444e-05, "policy_loss": -2.4653039872646332e-05, "vf_loss": 0.9159608483314514, "vf_explained_var": -0.0050449371337890625, "kl": 8.982827637282753e-08, "entropy": 1.7904927730560303, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600}, "sampler_results": {"episode_reward_max": 25.0, "episode_reward_min": 0.0, "episode_reward_mean": 8.9375, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 19.0}, "policy_reward_mean": {"ppo": 4.46875}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.9375, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.75, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.6875, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.34375, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.28125, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.1875, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.15625, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.09375, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.28125, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 0.96875, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.875, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.96875, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.125, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.09375, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.15625, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.4375, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.71875, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.3125, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.5625, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.375, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.28125, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.125, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.03125, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.15625, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.09375, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 0.96875, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.875, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.96875, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.875, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39579094944326243, "mean_inference_ms": 1.7444049184336994, "mean_action_processing_ms": 0.0812696517195998, "mean_env_wait_ms": 0.43934279057526704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 25.0, "episode_reward_min": 0.0, "episode_reward_mean": 8.9375, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 19.0}, "policy_reward_mean": {"ppo": 4.46875}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39579094944326243, "mean_inference_ms": 1.7444049184336994, "mean_action_processing_ms": 0.0812696517195998, "mean_env_wait_ms": 0.43934279057526704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600, "num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 12800, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 25600, "timers": {"training_iteration_time_ms": 1090.049, "learn_time_ms": 18.277, "learn_throughput": 43770.0, "synch_weights_time_ms": 1.885}, "counters": {"num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600}, "done": false, "episodes_total": 32, "training_iteration": 16, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-03-13", "timestamp": 1733745793, "time_this_iter_s": 1.1081092357635498, "time_total_s": 19.199588298797607, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 19.199588298797607, "timesteps_since_restore": 0, "iterations_since_restore": 16, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 26.2, "ram_util_percent": 75.9}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.147058823529411, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.882352941176471, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.676470588235294, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.5, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.264705882352941, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.2941176470588234, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.176470588235294, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.0588235294117647, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.2647058823529411, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8823529411764706, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.9705882352941178, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.1176470588235294, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.08823529411764706, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.14705882352941177, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.3823529411764706, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.7058823529411764, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.2647058823529411, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.6176470588235294, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.4411764705882353, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.2647058823529412, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.11764705882352941, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.029411764705882353, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.23529411764705882, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.08823529411764706, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8823529411764706, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8823529411764706, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 3.051757857974735e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 7.427670061588287e-05, "policy_loss": -1.483038067817688e-05, "vf_loss": 0.89103764295578, "vf_explained_var": -0.0006316304206848145, "kl": 1.68331752092854e-07, "entropy": 1.790014624595642, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 13600, "num_env_steps_trained": 13600, "num_agent_steps_sampled": 27200, "num_agent_steps_trained": 27200}, "sampler_results": {"episode_reward_max": 25.0, "episode_reward_min": 0.0, "episode_reward_mean": 9.147058823529411, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 19.0}, "policy_reward_mean": {"ppo": 4.573529411764706}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.147058823529411, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.882352941176471, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.676470588235294, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.5, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.264705882352941, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.2941176470588234, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.176470588235294, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.0588235294117647, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.2647058823529411, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8823529411764706, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.9705882352941178, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.1176470588235294, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.08823529411764706, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.14705882352941177, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.3823529411764706, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.7058823529411764, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.2647058823529411, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.6176470588235294, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.4411764705882353, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.2647058823529412, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.11764705882352941, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.029411764705882353, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.23529411764705882, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.08823529411764706, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8823529411764706, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8823529411764706, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0, 14.0, 11.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0, 11.0, 3.0, 8.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3958680529192722, "mean_inference_ms": 1.7440298925928415, "mean_action_processing_ms": 0.08091245933068655, "mean_env_wait_ms": 0.4387103507180421, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 25.0, "episode_reward_min": 0.0, "episode_reward_mean": 9.147058823529411, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 19.0}, "policy_reward_mean": {"ppo": 4.573529411764706}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0, 14.0, 11.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0, 11.0, 3.0, 8.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3958680529192722, "mean_inference_ms": 1.7440298925928415, "mean_action_processing_ms": 0.08091245933068655, "mean_env_wait_ms": 0.4387103507180421, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 27200, "num_agent_steps_trained": 27200, "num_env_steps_sampled": 13600, "num_env_steps_trained": 13600, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 13600, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 27200, "timers": {"training_iteration_time_ms": 1091.145, "learn_time_ms": 18.165, "learn_throughput": 44039.716, "synch_weights_time_ms": 1.685}, "counters": {"num_env_steps_sampled": 13600, "num_env_steps_trained": 13600, "num_agent_steps_sampled": 27200, "num_agent_steps_trained": 27200}, "done": false, "episodes_total": 34, "training_iteration": 17, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-03-14", "timestamp": 1733745794, "time_this_iter_s": 1.10176420211792, "time_total_s": 20.301352500915527, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 20.301352500915527, "timesteps_since_restore": 0, "iterations_since_restore": 17, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 33.6, "ram_util_percent": 75.9}}
{"custom_metrics": {"sparse_reward_mean": 0.5555555555555556, "sparse_reward_min": 0, "sparse_reward_max": 20, "shaped_reward_mean": 9.277777777777779, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.833333333333333, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.611111111111111, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.5, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.277777777777778, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.1666666666666665, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.138888888888889, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.1944444444444444, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 1.0833333333333333, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8611111111111112, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 3.0277777777777777, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.1666666666666665, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.08333333333333333, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.1388888888888889, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.4166666666666665, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.7777777777777777, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.3055555555555556, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.6666666666666666, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.5, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.25, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.1388888888888889, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.027777777777777776, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.2777777777777778, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.08333333333333333, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0833333333333333, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8611111111111112, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0833333333333333, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8611111111111112, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 1.5258789289873675e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 0.000199170783162117, "policy_loss": 6.4587220549583435e-06, "vf_loss": 1.9271316528320312, "vf_explained_var": 0.00170212984085083, "kl": 1.8571776649878302e-07, "entropy": 1.7902743816375732, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 14400, "num_env_steps_trained": 14400, "num_agent_steps_sampled": 28800, "num_agent_steps_trained": 28800}, "sampler_results": {"episode_reward_max": 54.0, "episode_reward_min": 0.0, "episode_reward_mean": 10.38888888888889, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 34.0}, "policy_reward_mean": {"ppo": 5.194444444444445}, "custom_metrics": {"sparse_reward_mean": 0.5555555555555556, "sparse_reward_min": 0, "sparse_reward_max": 20, "shaped_reward_mean": 9.277777777777779, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.833333333333333, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.611111111111111, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.5, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.277777777777778, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.1666666666666665, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.138888888888889, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.1944444444444444, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 1.0833333333333333, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8611111111111112, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 3.0277777777777777, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.1666666666666665, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.08333333333333333, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.1388888888888889, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.4166666666666665, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.7777777777777777, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.3055555555555556, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.6666666666666666, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.5, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.25, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.1388888888888889, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.027777777777777776, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.2777777777777778, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.08333333333333333, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0833333333333333, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8611111111111112, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0833333333333333, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8611111111111112, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0, 14.0, 11.0, 9.0, 54.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0, 11.0, 3.0, 8.0, 3.0, 6.0, 3.0, 34.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.395948165359565, "mean_inference_ms": 1.7434294864411912, "mean_action_processing_ms": 0.0805892339718181, "mean_env_wait_ms": 0.4383571115473085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 54.0, "episode_reward_min": 0.0, "episode_reward_mean": 10.38888888888889, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 34.0}, "policy_reward_mean": {"ppo": 5.194444444444445}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0, 14.0, 11.0, 9.0, 54.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0, 11.0, 3.0, 8.0, 3.0, 6.0, 3.0, 34.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.395948165359565, "mean_inference_ms": 1.7434294864411912, "mean_action_processing_ms": 0.0805892339718181, "mean_env_wait_ms": 0.4383571115473085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 28800, "num_agent_steps_trained": 28800, "num_env_steps_sampled": 14400, "num_env_steps_trained": 14400, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 14400, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 28800, "timers": {"training_iteration_time_ms": 1093.558, "learn_time_ms": 18.076, "learn_throughput": 44258.594, "synch_weights_time_ms": 1.675}, "counters": {"num_env_steps_sampled": 14400, "num_env_steps_trained": 14400, "num_agent_steps_sampled": 28800, "num_agent_steps_trained": 28800}, "done": false, "episodes_total": 36, "training_iteration": 18, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-03-15", "timestamp": 1733745795, "time_this_iter_s": 1.1061303615570068, "time_total_s": 21.407482862472534, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 21.407482862472534, "timesteps_since_restore": 0, "iterations_since_restore": 18, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 29.299999999999997, "ram_util_percent": 75.9}}
{"custom_metrics": {"sparse_reward_mean": 0.5263157894736842, "sparse_reward_min": 0, "sparse_reward_max": 20, "shaped_reward_mean": 9.026315789473685, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.842105263157895, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.7105263157894735, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.3684210526315788, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.157894736842105, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.236842105263158, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.2105263157894735, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.1578947368421053, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.368421052631579, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 1.0263157894736843, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.868421052631579, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.8684210526315788, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.0789473684210527, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.07894736842105263, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.15789473684210525, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.289473684210526, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.7105263157894737, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.236842105263158, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.631578947368421, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.47368421052631576, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.23684210526315788, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.13157894736842105, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.02631578947368421, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.2631578947368421, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.07894736842105263, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0263157894736843, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.868421052631579, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0263157894736843, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.868421052631579, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 7.629394644936838e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 4.595726204570383e-05, "policy_loss": 1.1527532478794456e-05, "vf_loss": 0.3442839980125427, "vf_explained_var": 0.004318118095397949, "kl": 2.69818627884888e-07, "entropy": 1.7898659706115723, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 15200, "num_env_steps_trained": 15200, "num_agent_steps_sampled": 30400, "num_agent_steps_trained": 30400}, "sampler_results": {"episode_reward_max": 54.0, "episode_reward_min": 0.0, "episode_reward_mean": 10.078947368421053, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 34.0}, "policy_reward_mean": {"ppo": 5.0394736842105265}, "custom_metrics": {"sparse_reward_mean": 0.5263157894736842, "sparse_reward_min": 0, "sparse_reward_max": 20, "shaped_reward_mean": 9.026315789473685, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.842105263157895, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.7105263157894735, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.3684210526315788, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.157894736842105, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.236842105263158, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.2105263157894735, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.1578947368421053, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.368421052631579, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 1.0263157894736843, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.868421052631579, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.8684210526315788, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.0789473684210527, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.07894736842105263, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.15789473684210525, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.289473684210526, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.7105263157894737, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.236842105263158, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.631578947368421, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.47368421052631576, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.23684210526315788, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.13157894736842105, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.02631578947368421, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.2631578947368421, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.07894736842105263, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0263157894736843, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.868421052631579, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0263157894736843, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.868421052631579, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0, 14.0, 11.0, 9.0, 54.0, 3.0, 6.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0, 11.0, 3.0, 8.0, 3.0, 6.0, 3.0, 34.0, 20.0, 0.0, 3.0, 0.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3959373921601208, "mean_inference_ms": 1.7429705699007332, "mean_action_processing_ms": 0.08026610837897555, "mean_env_wait_ms": 0.4384164404131432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 54.0, "episode_reward_min": 0.0, "episode_reward_mean": 10.078947368421053, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 34.0}, "policy_reward_mean": {"ppo": 5.0394736842105265}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0, 14.0, 11.0, 9.0, 54.0, 3.0, 6.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0, 11.0, 3.0, 8.0, 3.0, 6.0, 3.0, 34.0, 20.0, 0.0, 3.0, 0.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3959373921601208, "mean_inference_ms": 1.7429705699007332, "mean_action_processing_ms": 0.08026610837897555, "mean_env_wait_ms": 0.4384164404131432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 30400, "num_agent_steps_trained": 30400, "num_env_steps_sampled": 15200, "num_env_steps_trained": 15200, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 15200, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 30400, "timers": {"training_iteration_time_ms": 1099.851, "learn_time_ms": 18.764, "learn_throughput": 42635.548, "synch_weights_time_ms": 1.975}, "counters": {"num_env_steps_sampled": 15200, "num_env_steps_trained": 15200, "num_agent_steps_sampled": 30400, "num_agent_steps_trained": 30400}, "done": false, "episodes_total": 38, "training_iteration": 19, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-03-16", "timestamp": 1733745796, "time_this_iter_s": 1.1472516059875488, "time_total_s": 22.554734468460083, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 22.554734468460083, "timesteps_since_restore": 0, "iterations_since_restore": 19, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 28.75, "ram_util_percent": 75.9}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.5, "sparse_reward_min": 0, "sparse_reward_max": 20, "shaped_reward_mean": 9.075, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.95, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.675, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.475, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.175, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.325, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.125, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.15, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.3, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 1.025, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.9, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.825, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.125, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.075, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.15, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.275, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.75, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.175, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.675, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.45, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.25, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.125, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.05, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.25, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.075, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.025, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.9, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.025, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.9, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 3.814697322468419e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 7.099471986293793e-05, "policy_loss": 4.079192876815796e-07, "vf_loss": 0.705875039100647, "vf_explained_var": -0.0016294121742248535, "kl": 1.972250629478367e-07, "entropy": 1.78997004032135, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 54.0, "episode_reward_min": 0.0, "episode_reward_mean": 10.075, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 34.0}, "policy_reward_mean": {"ppo": 5.0375}, "custom_metrics": {"sparse_reward_mean": 0.5, "sparse_reward_min": 0, "sparse_reward_max": 20, "shaped_reward_mean": 9.075, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.95, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.675, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.475, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.175, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.325, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.125, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.15, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.3, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 1.025, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.9, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.825, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.125, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.075, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.15, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.275, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.75, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.175, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.675, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.45, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.25, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.125, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.05, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.25, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.075, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.025, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.9, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.025, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.9, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0, 14.0, 11.0, 9.0, 54.0, 3.0, 6.0, 6.0, 14.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0, 11.0, 3.0, 8.0, 3.0, 6.0, 3.0, 34.0, 20.0, 0.0, 3.0, 0.0, 6.0, 0.0, 6.0, 6.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3958408499436802, "mean_inference_ms": 1.7426246416853388, "mean_action_processing_ms": 0.07996696422726386, "mean_env_wait_ms": 0.43823581995470073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 54.0, "episode_reward_min": 0.0, "episode_reward_mean": 10.075, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 34.0}, "policy_reward_mean": {"ppo": 5.0375}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0, 14.0, 11.0, 9.0, 54.0, 3.0, 6.0, 6.0, 14.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0, 11.0, 3.0, 8.0, 3.0, 6.0, 3.0, 34.0, 20.0, 0.0, 3.0, 0.0, 6.0, 0.0, 6.0, 6.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3958408499436802, "mean_inference_ms": 1.7426246416853388, "mean_action_processing_ms": 0.07996696422726386, "mean_env_wait_ms": 0.43823581995470073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 16000, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 1093.9, "learn_time_ms": 18.598, "learn_throughput": 43014.587, "synch_weights_time_ms": 1.975}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 40, "training_iteration": 20, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-03-19", "timestamp": 1733745799, "time_this_iter_s": 2.4558279514312744, "time_total_s": 25.010562419891357, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 25.010562419891357, "timesteps_since_restore": 0, "iterations_since_restore": 20, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 25.900000000000002, "ram_util_percent": 75.9}}
{"custom_metrics": {"sparse_reward_mean": 0.47619047619047616, "sparse_reward_min": 0, "sparse_reward_max": 20, "shaped_reward_mean": 8.785714285714286, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.166666666666667, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.523809523809524, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.642857142857143, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.071428571428571, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.5238095238095237, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.023809523809524, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.1904761904761905, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.2619047619047619, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 1.0238095238095237, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8571428571428571, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.7142857142857144, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.1666666666666665, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.07142857142857142, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.14285714285714285, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.1904761904761907, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.7857142857142858, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.1428571428571428, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.6666666666666666, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.42857142857142855, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.23809523809523808, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.11904761904761904, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.047619047619047616, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.23809523809523808, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.07142857142857142, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0238095238095237, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8571428571428571, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0238095238095237, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8571428571428571, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 1.9073486612342094e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 2.790987491607666e-05, "policy_loss": 8.374452590942383e-06, "vf_loss": 0.19534561038017273, "vf_explained_var": 0.0072779059410095215, "kl": 1.3826135614181112e-07, "entropy": 1.7900116443634033, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 16800, "num_env_steps_trained": 16800, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33600}, "sampler_results": {"episode_reward_max": 54.0, "episode_reward_min": 0.0, "episode_reward_mean": 9.738095238095237, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 34.0}, "policy_reward_mean": {"ppo": 4.869047619047619}, "custom_metrics": {"sparse_reward_mean": 0.47619047619047616, "sparse_reward_min": 0, "sparse_reward_max": 20, "shaped_reward_mean": 8.785714285714286, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.166666666666667, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.523809523809524, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.642857142857143, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.071428571428571, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.5238095238095237, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.023809523809524, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.1904761904761905, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.2619047619047619, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 1.0238095238095237, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8571428571428571, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.7142857142857144, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.1666666666666665, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.07142857142857142, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.14285714285714285, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.1904761904761907, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.7857142857142858, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.1428571428571428, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.6666666666666666, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.42857142857142855, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.23809523809523808, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.11904761904761904, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.047619047619047616, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.23809523809523808, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 3, "soup_drop_agent_1_mean": 0.07142857142857142, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0238095238095237, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8571428571428571, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0238095238095237, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8571428571428571, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0, 14.0, 11.0, 9.0, 54.0, 3.0, 6.0, 6.0, 14.0, 3.0, 3.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0, 11.0, 3.0, 8.0, 3.0, 6.0, 3.0, 34.0, 20.0, 0.0, 3.0, 0.0, 6.0, 0.0, 6.0, 6.0, 8.0, 3.0, 0.0, 3.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3957031689230043, "mean_inference_ms": 1.742127968218512, "mean_action_processing_ms": 0.07977591654801361, "mean_env_wait_ms": 0.43827890950228177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 54.0, "episode_reward_min": 0.0, "episode_reward_mean": 9.738095238095237, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 34.0}, "policy_reward_mean": {"ppo": 4.869047619047619}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0, 14.0, 11.0, 9.0, 54.0, 3.0, 6.0, 6.0, 14.0, 3.0, 3.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0, 11.0, 3.0, 8.0, 3.0, 6.0, 3.0, 34.0, 20.0, 0.0, 3.0, 0.0, 6.0, 0.0, 6.0, 6.0, 8.0, 3.0, 0.0, 3.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3957031689230043, "mean_inference_ms": 1.742127968218512, "mean_action_processing_ms": 0.07977591654801361, "mean_env_wait_ms": 0.43827890950228177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33600, "num_env_steps_sampled": 16800, "num_env_steps_trained": 16800, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 16800, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 33600, "timers": {"training_iteration_time_ms": 1091.465, "learn_time_ms": 17.717, "learn_throughput": 45154.969, "synch_weights_time_ms": 1.975}, "counters": {"num_env_steps_sampled": 16800, "num_env_steps_trained": 16800, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33600}, "done": false, "episodes_total": 42, "training_iteration": 21, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-03-20", "timestamp": 1733745800, "time_this_iter_s": 1.1059699058532715, "time_total_s": 26.11653232574463, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 26.11653232574463, "timesteps_since_restore": 0, "iterations_since_restore": 21, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 25.65, "ram_util_percent": 75.9}}
{"custom_metrics": {"sparse_reward_mean": 0.45454545454545453, "sparse_reward_min": 0, "sparse_reward_max": 20, "shaped_reward_mean": 8.772727272727273, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.181818181818182, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.5227272727272725, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.659090909090909, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.090909090909091, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.5681818181818183, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.0, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.1818181818181819, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.25, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8863636363636364, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.727272727272727, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.159090909090909, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.06818181818181818, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.13636363636363635, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.1818181818181817, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.7727272727272727, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.0909090909090908, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.7045454545454546, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.5227272727272727, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 5, "soup_pickup_agent_1_mean": 0.22727272727272727, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.11363636363636363, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.045454545454545456, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.3409090909090909, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 5, "soup_drop_agent_1_mean": 0.06818181818181818, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8863636363636364, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8863636363636364, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 9.536743306171047e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 3.8905069231987e-05, "policy_loss": -1.9544735550880432e-05, "vf_loss": 0.5845288634300232, "vf_explained_var": 0.003855466842651367, "kl": 1.2440391117252148e-07, "entropy": 1.7899038791656494, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 17600, "num_env_steps_trained": 17600, "num_agent_steps_sampled": 35200, "num_agent_steps_trained": 35200}, "sampler_results": {"episode_reward_max": 54.0, "episode_reward_min": 0.0, "episode_reward_mean": 9.681818181818182, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 34.0}, "policy_reward_mean": {"ppo": 4.840909090909091}, "custom_metrics": {"sparse_reward_mean": 0.45454545454545453, "sparse_reward_min": 0, "sparse_reward_max": 20, "shaped_reward_mean": 8.772727272727273, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.181818181818182, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.5227272727272725, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.659090909090909, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.090909090909091, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.5681818181818183, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.0, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.1818181818181819, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.25, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8863636363636364, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.727272727272727, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.159090909090909, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.06818181818181818, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.13636363636363635, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.1818181818181817, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.7727272727272727, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.0909090909090908, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.7045454545454546, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.5227272727272727, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 5, "soup_pickup_agent_1_mean": 0.22727272727272727, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.11363636363636363, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.045454545454545456, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.3409090909090909, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 5, "soup_drop_agent_1_mean": 0.06818181818181818, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8863636363636364, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8863636363636364, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0, 14.0, 11.0, 9.0, 54.0, 3.0, 6.0, 6.0, 14.0, 3.0, 3.0, 3.0, 14.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0, 11.0, 3.0, 8.0, 3.0, 6.0, 3.0, 34.0, 20.0, 0.0, 3.0, 0.0, 6.0, 0.0, 6.0, 6.0, 8.0, 3.0, 0.0, 3.0, 0.0, 0.0, 3.0, 8.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39546261974388525, "mean_inference_ms": 1.7416796618132304, "mean_action_processing_ms": 0.07952621288005345, "mean_env_wait_ms": 0.4383832259392415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 54.0, "episode_reward_min": 0.0, "episode_reward_mean": 9.681818181818182, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 34.0}, "policy_reward_mean": {"ppo": 4.840909090909091}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0, 14.0, 11.0, 9.0, 54.0, 3.0, 6.0, 6.0, 14.0, 3.0, 3.0, 3.0, 14.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0, 11.0, 3.0, 8.0, 3.0, 6.0, 3.0, 34.0, 20.0, 0.0, 3.0, 0.0, 6.0, 0.0, 6.0, 6.0, 8.0, 3.0, 0.0, 3.0, 0.0, 0.0, 3.0, 8.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39546261974388525, "mean_inference_ms": 1.7416796618132304, "mean_action_processing_ms": 0.07952621288005345, "mean_env_wait_ms": 0.4383832259392415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 35200, "num_agent_steps_trained": 35200, "num_env_steps_sampled": 17600, "num_env_steps_trained": 17600, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 17600, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 35200, "timers": {"training_iteration_time_ms": 1091.808, "learn_time_ms": 17.726, "learn_throughput": 45131.04, "synch_weights_time_ms": 1.947}, "counters": {"num_env_steps_sampled": 17600, "num_env_steps_trained": 17600, "num_agent_steps_sampled": 35200, "num_agent_steps_trained": 35200}, "done": false, "episodes_total": 44, "training_iteration": 22, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-03-21", "timestamp": 1733745801, "time_this_iter_s": 1.0850410461425781, "time_total_s": 27.201573371887207, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 27.201573371887207, "timesteps_since_restore": 0, "iterations_since_restore": 22, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 30.55, "ram_util_percent": 75.9}}
{"custom_metrics": {"sparse_reward_mean": 0.43478260869565216, "sparse_reward_min": 0, "sparse_reward_max": 20, "shaped_reward_mean": 8.826086956521738, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.239130434782608, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.608695652173913, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.782608695652174, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.195652173913044, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.630434782608696, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.021739130434782, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.1304347826086956, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.2173913043478262, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 0.9782608695652174, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.9347826086956522, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.630434782608696, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.0869565217391304, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.06521739130434782, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.13043478260869565, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.108695652173913, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.6956521739130435, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.0434782608695652, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.6739130434782609, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.5, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 5, "soup_pickup_agent_1_mean": 0.2391304347826087, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.10869565217391304, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.043478260869565216, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.32608695652173914, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 5, "soup_drop_agent_1_mean": 0.08695652173913043, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 0.9782608695652174, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.9347826086956522, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9782608695652174, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.9347826086956522, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 4.7683716530855236e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 4.9959635362029076e-05, "policy_loss": -3.1095463782548904e-05, "vf_loss": 0.8105567693710327, "vf_explained_var": -0.00011703372001647949, "kl": 2.4833866518747527e-07, "entropy": 1.789750337600708, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 18400, "num_env_steps_trained": 18400, "num_agent_steps_sampled": 36800, "num_agent_steps_trained": 36800}, "sampler_results": {"episode_reward_max": 54.0, "episode_reward_min": 0.0, "episode_reward_mean": 9.695652173913043, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 34.0}, "policy_reward_mean": {"ppo": 4.8478260869565215}, "custom_metrics": {"sparse_reward_mean": 0.43478260869565216, "sparse_reward_min": 0, "sparse_reward_max": 20, "shaped_reward_mean": 8.826086956521738, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.239130434782608, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.608695652173913, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.782608695652174, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.195652173913044, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.630434782608696, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.021739130434782, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.1304347826086956, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.2173913043478262, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 0.9782608695652174, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.9347826086956522, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.630434782608696, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.0869565217391304, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.06521739130434782, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.13043478260869565, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.108695652173913, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.6956521739130435, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.0434782608695652, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.6739130434782609, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.5, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 5, "soup_pickup_agent_1_mean": 0.2391304347826087, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.10869565217391304, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.043478260869565216, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.32608695652173914, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 5, "soup_drop_agent_1_mean": 0.08695652173913043, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 0.9782608695652174, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.9347826086956522, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9782608695652174, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.9347826086956522, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0, 14.0, 11.0, 9.0, 54.0, 3.0, 6.0, 6.0, 14.0, 3.0, 3.0, 3.0, 14.0, 11.0, 9.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0, 11.0, 3.0, 8.0, 3.0, 6.0, 3.0, 34.0, 20.0, 0.0, 3.0, 0.0, 6.0, 0.0, 6.0, 6.0, 8.0, 3.0, 0.0, 3.0, 0.0, 0.0, 3.0, 8.0, 6.0, 3.0, 8.0, 0.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3951764270821485, "mean_inference_ms": 1.741234917897391, "mean_action_processing_ms": 0.07923947247380288, "mean_env_wait_ms": 0.43860866430921025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 54.0, "episode_reward_min": 0.0, "episode_reward_mean": 9.695652173913043, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 34.0}, "policy_reward_mean": {"ppo": 4.8478260869565215}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0, 14.0, 11.0, 9.0, 54.0, 3.0, 6.0, 6.0, 14.0, 3.0, 3.0, 3.0, 14.0, 11.0, 9.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0, 11.0, 3.0, 8.0, 3.0, 6.0, 3.0, 34.0, 20.0, 0.0, 3.0, 0.0, 6.0, 0.0, 6.0, 6.0, 8.0, 3.0, 0.0, 3.0, 0.0, 0.0, 3.0, 8.0, 6.0, 3.0, 8.0, 0.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3951764270821485, "mean_inference_ms": 1.741234917897391, "mean_action_processing_ms": 0.07923947247380288, "mean_env_wait_ms": 0.43860866430921025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 36800, "num_agent_steps_trained": 36800, "num_env_steps_sampled": 18400, "num_env_steps_trained": 18400, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 18400, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 36800, "timers": {"training_iteration_time_ms": 1090.617, "learn_time_ms": 18.715, "learn_throughput": 42746.133, "synch_weights_time_ms": 1.947}, "counters": {"num_env_steps_sampled": 18400, "num_env_steps_trained": 18400, "num_agent_steps_sampled": 36800, "num_agent_steps_trained": 36800}, "done": false, "episodes_total": 46, "training_iteration": 23, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-03-22", "timestamp": 1733745802, "time_this_iter_s": 1.1043846607208252, "time_total_s": 28.305958032608032, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 28.305958032608032, "timesteps_since_restore": 0, "iterations_since_restore": 23, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 37.8, "ram_util_percent": 75.9}}
{"custom_metrics": {"sparse_reward_mean": 0.4166666666666667, "sparse_reward_min": 0, "sparse_reward_max": 20, "shaped_reward_mean": 8.8125, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.1875, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.666666666666667, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.7291666666666665, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.208333333333333, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.5833333333333335, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.0625, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.125, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.2708333333333333, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 0.9791666666666666, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.9375, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.6875, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.1875, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.0625, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.125, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.1666666666666665, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.8125, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.0416666666666667, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.7083333333333334, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.5, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 5, "soup_pickup_agent_1_mean": 0.22916666666666666, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.10416666666666667, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.041666666666666664, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.3125, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 5, "soup_drop_agent_1_mean": 0.08333333333333333, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 0.9791666666666666, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.9375, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9791666666666666, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.9375, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 2.3841858265427618e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 5.6639022659510374e-05, "policy_loss": -2.753135049715638e-06, "vf_loss": 0.5939124822616577, "vf_explained_var": 0.005691260099411011, "kl": 1.9678661544730858e-07, "entropy": 1.7897844314575195, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 19200, "num_env_steps_trained": 19200, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38400}, "sampler_results": {"episode_reward_max": 54.0, "episode_reward_min": 0.0, "episode_reward_mean": 9.645833333333334, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 34.0}, "policy_reward_mean": {"ppo": 4.822916666666667}, "custom_metrics": {"sparse_reward_mean": 0.4166666666666667, "sparse_reward_min": 0, "sparse_reward_max": 20, "shaped_reward_mean": 8.8125, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.1875, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.666666666666667, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.7291666666666665, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.208333333333333, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.5833333333333335, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.0625, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.125, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.2708333333333333, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 0.9791666666666666, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.9375, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.6875, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.1875, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.0625, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.125, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.1666666666666665, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.8125, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.0416666666666667, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.7083333333333334, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.5, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 5, "soup_pickup_agent_1_mean": 0.22916666666666666, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.10416666666666667, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.041666666666666664, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.3125, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 5, "soup_drop_agent_1_mean": 0.08333333333333333, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 0.9791666666666666, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.9375, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9791666666666666, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.9375, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0, 14.0, 11.0, 9.0, 54.0, 3.0, 6.0, 6.0, 14.0, 3.0, 3.0, 3.0, 14.0, 11.0, 9.0, 6.0, 11.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0, 11.0, 3.0, 8.0, 3.0, 6.0, 3.0, 34.0, 20.0, 0.0, 3.0, 0.0, 6.0, 0.0, 6.0, 6.0, 8.0, 3.0, 0.0, 3.0, 0.0, 0.0, 3.0, 8.0, 6.0, 3.0, 8.0, 0.0, 9.0, 3.0, 3.0, 8.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39490103610516814, "mean_inference_ms": 1.7407824937002365, "mean_action_processing_ms": 0.0790385906213318, "mean_env_wait_ms": 0.43880797329796845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 54.0, "episode_reward_min": 0.0, "episode_reward_mean": 9.645833333333334, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 34.0}, "policy_reward_mean": {"ppo": 4.822916666666667}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0, 14.0, 11.0, 9.0, 54.0, 3.0, 6.0, 6.0, 14.0, 3.0, 3.0, 3.0, 14.0, 11.0, 9.0, 6.0, 11.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0, 11.0, 3.0, 8.0, 3.0, 6.0, 3.0, 34.0, 20.0, 0.0, 3.0, 0.0, 6.0, 0.0, 6.0, 6.0, 8.0, 3.0, 0.0, 3.0, 0.0, 0.0, 3.0, 8.0, 6.0, 3.0, 8.0, 0.0, 9.0, 3.0, 3.0, 8.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39490103610516814, "mean_inference_ms": 1.7407824937002365, "mean_action_processing_ms": 0.0790385906213318, "mean_env_wait_ms": 0.43880797329796845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38400, "num_env_steps_sampled": 19200, "num_env_steps_trained": 19200, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 19200, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 38400, "timers": {"training_iteration_time_ms": 1094.925, "learn_time_ms": 18.397, "learn_throughput": 43484.906, "synch_weights_time_ms": 1.647}, "counters": {"num_env_steps_sampled": 19200, "num_env_steps_trained": 19200, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38400}, "done": false, "episodes_total": 48, "training_iteration": 24, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-03-24", "timestamp": 1733745804, "time_this_iter_s": 1.1126856803894043, "time_total_s": 29.418643712997437, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 29.418643712997437, "timesteps_since_restore": 0, "iterations_since_restore": 24, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 36.099999999999994, "ram_util_percent": 76.0}}
{"custom_metrics": {"sparse_reward_mean": 0.4, "sparse_reward_min": 0, "sparse_reward_max": 20, "shaped_reward_mean": 8.8, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.06, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.64, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.66, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.22, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.52, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.02, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.12, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.22, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 0.94, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.96, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.72, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.3, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.06, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.14, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.18, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.92, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.0, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.7, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.48, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 5, "soup_pickup_agent_1_mean": 0.24, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.1, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.06, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.3, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 5, "soup_drop_agent_1_mean": 0.08, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 0.94, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.96, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.94, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.96, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 1.1920929132713809e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 5.3254421800374985e-05, "policy_loss": -5.0854869186878204e-06, "vf_loss": 0.5834110379219055, "vf_explained_var": 0.004708528518676758, "kl": 2.408575596746232e-07, "entropy": 1.789581537246704, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 54.0, "episode_reward_min": 0.0, "episode_reward_mean": 9.6, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 34.0}, "policy_reward_mean": {"ppo": 4.8}, "custom_metrics": {"sparse_reward_mean": 0.4, "sparse_reward_min": 0, "sparse_reward_max": 20, "shaped_reward_mean": 8.8, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.06, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.64, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.66, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.22, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.52, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.02, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.12, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.22, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 0.94, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.96, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.72, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.3, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.06, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.14, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.18, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.92, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.0, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.7, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.48, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 5, "soup_pickup_agent_1_mean": 0.24, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.1, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.06, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.3, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 5, "soup_drop_agent_1_mean": 0.08, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 0.94, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.96, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.94, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.96, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0, 14.0, 11.0, 9.0, 54.0, 3.0, 6.0, 6.0, 14.0, 3.0, 3.0, 3.0, 14.0, 11.0, 9.0, 6.0, 11.0, 8.0, 9.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0, 11.0, 3.0, 8.0, 3.0, 6.0, 3.0, 34.0, 20.0, 0.0, 3.0, 0.0, 6.0, 0.0, 6.0, 6.0, 8.0, 3.0, 0.0, 3.0, 0.0, 0.0, 3.0, 8.0, 6.0, 3.0, 8.0, 0.0, 9.0, 3.0, 3.0, 8.0, 3.0, 0.0, 8.0, 0.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39466850035644285, "mean_inference_ms": 1.7401990429476926, "mean_action_processing_ms": 0.07882157437830456, "mean_env_wait_ms": 0.4390934544597891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 54.0, "episode_reward_min": 0.0, "episode_reward_mean": 9.6, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 34.0}, "policy_reward_mean": {"ppo": 4.8}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0, 14.0, 11.0, 9.0, 54.0, 3.0, 6.0, 6.0, 14.0, 3.0, 3.0, 3.0, 14.0, 11.0, 9.0, 6.0, 11.0, 8.0, 9.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0, 11.0, 3.0, 8.0, 3.0, 6.0, 3.0, 34.0, 20.0, 0.0, 3.0, 0.0, 6.0, 0.0, 6.0, 6.0, 8.0, 3.0, 0.0, 3.0, 0.0, 0.0, 3.0, 8.0, 6.0, 3.0, 8.0, 0.0, 9.0, 3.0, 3.0, 8.0, 3.0, 0.0, 8.0, 0.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39466850035644285, "mean_inference_ms": 1.7401990429476926, "mean_action_processing_ms": 0.07882157437830456, "mean_env_wait_ms": 0.4390934544597891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 20000, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 1085.717, "learn_time_ms": 16.698, "learn_throughput": 47911.289, "synch_weights_time_ms": 2.091}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 50, "training_iteration": 25, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-03-25", "timestamp": 1733745805, "time_this_iter_s": 1.0798115730285645, "time_total_s": 30.498455286026, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 30.498455286026, "timesteps_since_restore": 0, "iterations_since_restore": 25, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 28.55, "ram_util_percent": 75.95}}
{"custom_metrics": {"sparse_reward_mean": 0.38461538461538464, "sparse_reward_min": 0, "sparse_reward_max": 20, "shaped_reward_mean": 8.692307692307692, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.9423076923076925, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.634615384615385, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.576923076923077, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.25, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.4038461538461537, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.0, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.0769230769230769, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.1923076923076923, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 0.9230769230769231, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.9807692307692307, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.769230769230769, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.269230769230769, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.057692307692307696, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.1346153846153846, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.25, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.8846153846153846, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.0769230769230769, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.7115384615384616, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.46153846153846156, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 5, "soup_pickup_agent_1_mean": 0.23076923076923078, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.09615384615384616, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.057692307692307696, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.28846153846153844, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 5, "soup_drop_agent_1_mean": 0.07692307692307693, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 0.9230769230769231, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.9807692307692307, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9230769230769231, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.9807692307692307, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 5.9604645663569045e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 4.5983120799064636e-05, "policy_loss": 6.4373016357421875e-06, "vf_loss": 0.39539414644241333, "vf_explained_var": 0.013260304927825928, "kl": 1.6106494626910717e-07, "entropy": 1.7898787260055542, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 20800, "num_env_steps_trained": 20800, "num_agent_steps_sampled": 41600, "num_agent_steps_trained": 41600}, "sampler_results": {"episode_reward_max": 54.0, "episode_reward_min": 0.0, "episode_reward_mean": 9.461538461538462, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 34.0}, "policy_reward_mean": {"ppo": 4.730769230769231}, "custom_metrics": {"sparse_reward_mean": 0.38461538461538464, "sparse_reward_min": 0, "sparse_reward_max": 20, "shaped_reward_mean": 8.692307692307692, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.9423076923076925, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.634615384615385, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.576923076923077, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.25, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.4038461538461537, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.0, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.0769230769230769, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.1923076923076923, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 0.9230769230769231, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.9807692307692307, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.769230769230769, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.269230769230769, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.057692307692307696, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.1346153846153846, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.25, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.8846153846153846, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.0769230769230769, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.7115384615384616, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.46153846153846156, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 5, "soup_pickup_agent_1_mean": 0.23076923076923078, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.09615384615384616, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.057692307692307696, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.28846153846153844, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 5, "soup_drop_agent_1_mean": 0.07692307692307693, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 0.9230769230769231, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.9807692307692307, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9230769230769231, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.9807692307692307, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0, 14.0, 11.0, 9.0, 54.0, 3.0, 6.0, 6.0, 14.0, 3.0, 3.0, 3.0, 14.0, 11.0, 9.0, 6.0, 11.0, 8.0, 9.0, 3.0, 9.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0, 11.0, 3.0, 8.0, 3.0, 6.0, 3.0, 34.0, 20.0, 0.0, 3.0, 0.0, 6.0, 0.0, 6.0, 6.0, 8.0, 3.0, 0.0, 3.0, 0.0, 0.0, 3.0, 8.0, 6.0, 3.0, 8.0, 0.0, 9.0, 3.0, 3.0, 8.0, 3.0, 0.0, 8.0, 0.0, 9.0, 0.0, 3.0, 3.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3943191084011207, "mean_inference_ms": 1.7396945381284825, "mean_action_processing_ms": 0.07859033129110449, "mean_env_wait_ms": 0.4395271224418523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 54.0, "episode_reward_min": 0.0, "episode_reward_mean": 9.461538461538462, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 34.0}, "policy_reward_mean": {"ppo": 4.730769230769231}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0, 14.0, 11.0, 9.0, 54.0, 3.0, 6.0, 6.0, 14.0, 3.0, 3.0, 3.0, 14.0, 11.0, 9.0, 6.0, 11.0, 8.0, 9.0, 3.0, 9.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0, 11.0, 3.0, 8.0, 3.0, 6.0, 3.0, 34.0, 20.0, 0.0, 3.0, 0.0, 6.0, 0.0, 6.0, 6.0, 8.0, 3.0, 0.0, 3.0, 0.0, 0.0, 3.0, 8.0, 6.0, 3.0, 8.0, 0.0, 9.0, 3.0, 3.0, 8.0, 3.0, 0.0, 8.0, 0.0, 9.0, 0.0, 3.0, 3.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3943191084011207, "mean_inference_ms": 1.7396945381284825, "mean_action_processing_ms": 0.07859033129110449, "mean_env_wait_ms": 0.4395271224418523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 41600, "num_agent_steps_trained": 41600, "num_env_steps_sampled": 20800, "num_env_steps_trained": 20800, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 20800, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 41600, "timers": {"training_iteration_time_ms": 1086.221, "learn_time_ms": 16.256, "learn_throughput": 49213.324, "synch_weights_time_ms": 2.425}, "counters": {"num_env_steps_sampled": 20800, "num_env_steps_trained": 20800, "num_agent_steps_sampled": 41600, "num_agent_steps_trained": 41600}, "done": false, "episodes_total": 52, "training_iteration": 26, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-03-26", "timestamp": 1733745806, "time_this_iter_s": 1.113027572631836, "time_total_s": 31.611482858657837, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 31.611482858657837, "timesteps_since_restore": 0, "iterations_since_restore": 26, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 32.0, "ram_util_percent": 76.0}}
{"custom_metrics": {"sparse_reward_mean": 0.37037037037037035, "sparse_reward_min": 0, "sparse_reward_max": 20, "shaped_reward_mean": 8.87037037037037, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.944444444444445, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.611111111111111, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.5555555555555554, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.203703703703703, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.4074074074074074, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 3.9814814814814814, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.1111111111111112, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.2037037037037037, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 0.9259259259259259, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.9814814814814815, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.7962962962962963, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.2962962962962963, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.05555555555555555, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.12962962962962962, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.259259259259259, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.8888888888888888, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.1296296296296295, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.7407407407407407, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.5, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 5, "soup_pickup_agent_1_mean": 0.25925925925925924, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.1111111111111111, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.05555555555555555, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.3148148148148148, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 5, "soup_drop_agent_1_mean": 0.09259259259259259, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 0.9259259259259259, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.9814814814814815, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9259259259259259, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.9814814814814815, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 2.9802322831784522e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 9.573623538017273e-05, "policy_loss": -1.2759119272232056e-05, "vf_loss": 1.0849888324737549, "vf_explained_var": -0.0030156970024108887, "kl": 1.996165650552939e-07, "entropy": 1.7893379926681519, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 21600, "num_env_steps_trained": 21600, "num_agent_steps_sampled": 43200, "num_agent_steps_trained": 43200}, "sampler_results": {"episode_reward_max": 54.0, "episode_reward_min": 0.0, "episode_reward_mean": 9.61111111111111, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 34.0}, "policy_reward_mean": {"ppo": 4.805555555555555}, "custom_metrics": {"sparse_reward_mean": 0.37037037037037035, "sparse_reward_min": 0, "sparse_reward_max": 20, "shaped_reward_mean": 8.87037037037037, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.944444444444445, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.611111111111111, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.5555555555555554, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.203703703703703, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.4074074074074074, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 3.9814814814814814, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.1111111111111112, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.2037037037037037, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 0.9259259259259259, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.9814814814814815, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.7962962962962963, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.2962962962962963, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.05555555555555555, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.12962962962962962, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.259259259259259, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.8888888888888888, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.1296296296296295, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.7407407407407407, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.5, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 5, "soup_pickup_agent_1_mean": 0.25925925925925924, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.1111111111111111, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.05555555555555555, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.3148148148148148, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 5, "soup_drop_agent_1_mean": 0.09259259259259259, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 0.9259259259259259, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.9814814814814815, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9259259259259259, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.9814814814814815, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0, 14.0, 11.0, 9.0, 54.0, 3.0, 6.0, 6.0, 14.0, 3.0, 3.0, 3.0, 14.0, 11.0, 9.0, 6.0, 11.0, 8.0, 9.0, 3.0, 9.0, 8.0, 19.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0, 11.0, 3.0, 8.0, 3.0, 6.0, 3.0, 34.0, 20.0, 0.0, 3.0, 0.0, 6.0, 0.0, 6.0, 6.0, 8.0, 3.0, 0.0, 3.0, 0.0, 0.0, 3.0, 8.0, 6.0, 3.0, 8.0, 0.0, 9.0, 3.0, 3.0, 8.0, 3.0, 0.0, 8.0, 0.0, 9.0, 0.0, 3.0, 3.0, 6.0, 5.0, 3.0, 6.0, 13.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3939731760217512, "mean_inference_ms": 1.7392942841174461, "mean_action_processing_ms": 0.07838129742485472, "mean_env_wait_ms": 0.4399315348216496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 54.0, "episode_reward_min": 0.0, "episode_reward_mean": 9.61111111111111, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 34.0}, "policy_reward_mean": {"ppo": 4.805555555555555}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0, 14.0, 11.0, 9.0, 54.0, 3.0, 6.0, 6.0, 14.0, 3.0, 3.0, 3.0, 14.0, 11.0, 9.0, 6.0, 11.0, 8.0, 9.0, 3.0, 9.0, 8.0, 19.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0, 11.0, 3.0, 8.0, 3.0, 6.0, 3.0, 34.0, 20.0, 0.0, 3.0, 0.0, 6.0, 0.0, 6.0, 6.0, 8.0, 3.0, 0.0, 3.0, 0.0, 0.0, 3.0, 8.0, 6.0, 3.0, 8.0, 0.0, 9.0, 3.0, 3.0, 8.0, 3.0, 0.0, 8.0, 0.0, 9.0, 0.0, 3.0, 3.0, 6.0, 5.0, 3.0, 6.0, 13.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3939731760217512, "mean_inference_ms": 1.7392942841174461, "mean_action_processing_ms": 0.07838129742485472, "mean_env_wait_ms": 0.4399315348216496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 43200, "num_agent_steps_trained": 43200, "num_env_steps_sampled": 21600, "num_env_steps_trained": 21600, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 21600, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 43200, "timers": {"training_iteration_time_ms": 1087.646, "learn_time_ms": 16.299, "learn_throughput": 49082.307, "synch_weights_time_ms": 2.425}, "counters": {"num_env_steps_sampled": 21600, "num_env_steps_trained": 21600, "num_agent_steps_sampled": 43200, "num_agent_steps_trained": 43200}, "done": false, "episodes_total": 54, "training_iteration": 27, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-03-27", "timestamp": 1733745807, "time_this_iter_s": 1.1147093772888184, "time_total_s": 32.726192235946655, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 32.726192235946655, "timesteps_since_restore": 0, "iterations_since_restore": 27, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 25.7, "ram_util_percent": 76.0}}
{"custom_metrics": {"sparse_reward_mean": 0.35714285714285715, "sparse_reward_min": 0, "sparse_reward_max": 20, "shaped_reward_mean": 8.607142857142858, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.0, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.446428571428571, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.6607142857142856, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.089285714285714, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.482142857142857, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 3.875, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.0714285714285714, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.1607142857142858, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 0.9107142857142857, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.9464285714285714, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.8392857142857144, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.2857142857142856, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.05357142857142857, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.125, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.3035714285714284, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.8571428571428572, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.2142857142857142, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.75, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.48214285714285715, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 5, "soup_pickup_agent_1_mean": 0.25, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.10714285714285714, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.05357142857142857, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.30357142857142855, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 5, "soup_drop_agent_1_mean": 0.08928571428571429, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 0.9107142857142857, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.9464285714285714, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9107142857142857, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.9464285714285714, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 1.4901161415892261e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 4.309695214033127e-06, "policy_loss": -5.614478141069412e-06, "vf_loss": 0.09925475716590881, "vf_explained_var": -0.010244607925415039, "kl": 1.4927901759165252e-07, "entropy": 1.789860725402832, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 22400, "num_env_steps_trained": 22400, "num_agent_steps_sampled": 44800, "num_agent_steps_trained": 44800}, "sampler_results": {"episode_reward_max": 54.0, "episode_reward_min": 0.0, "episode_reward_mean": 9.321428571428571, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 34.0}, "policy_reward_mean": {"ppo": 4.660714285714286}, "custom_metrics": {"sparse_reward_mean": 0.35714285714285715, "sparse_reward_min": 0, "sparse_reward_max": 20, "shaped_reward_mean": 8.607142857142858, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.0, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.446428571428571, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.6607142857142856, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.089285714285714, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.482142857142857, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 3.875, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.0714285714285714, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.1607142857142858, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 0.9107142857142857, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.9464285714285714, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.8392857142857144, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.2857142857142856, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 8, "useful_dish_pickup_agent_0_mean": 0.05357142857142857, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.125, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.3035714285714284, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.8571428571428572, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.2142857142857142, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.75, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.48214285714285715, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 5, "soup_pickup_agent_1_mean": 0.25, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.10714285714285714, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.05357142857142857, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.30357142857142855, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 5, "soup_drop_agent_1_mean": 0.08928571428571429, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 0.9107142857142857, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.9464285714285714, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9107142857142857, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.9464285714285714, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0, 14.0, 11.0, 9.0, 54.0, 3.0, 6.0, 6.0, 14.0, 3.0, 3.0, 3.0, 14.0, 11.0, 9.0, 6.0, 11.0, 8.0, 9.0, 3.0, 9.0, 8.0, 19.0, 3.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0, 11.0, 3.0, 8.0, 3.0, 6.0, 3.0, 34.0, 20.0, 0.0, 3.0, 0.0, 6.0, 0.0, 6.0, 6.0, 8.0, 3.0, 0.0, 3.0, 0.0, 0.0, 3.0, 8.0, 6.0, 3.0, 8.0, 0.0, 9.0, 3.0, 3.0, 8.0, 3.0, 0.0, 8.0, 0.0, 9.0, 0.0, 3.0, 3.0, 6.0, 5.0, 3.0, 6.0, 13.0, 3.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3936657111355692, "mean_inference_ms": 1.7388992940660837, "mean_action_processing_ms": 0.07818281219006337, "mean_env_wait_ms": 0.44029335396379715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 54.0, "episode_reward_min": 0.0, "episode_reward_mean": 9.321428571428571, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 34.0}, "policy_reward_mean": {"ppo": 4.660714285714286}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0, 14.0, 11.0, 9.0, 54.0, 3.0, 6.0, 6.0, 14.0, 3.0, 3.0, 3.0, 14.0, 11.0, 9.0, 6.0, 11.0, 8.0, 9.0, 3.0, 9.0, 8.0, 19.0, 3.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0, 11.0, 3.0, 8.0, 3.0, 6.0, 3.0, 34.0, 20.0, 0.0, 3.0, 0.0, 6.0, 0.0, 6.0, 6.0, 8.0, 3.0, 0.0, 3.0, 0.0, 0.0, 3.0, 8.0, 6.0, 3.0, 8.0, 0.0, 9.0, 3.0, 3.0, 8.0, 3.0, 0.0, 8.0, 0.0, 9.0, 0.0, 3.0, 3.0, 6.0, 5.0, 3.0, 6.0, 13.0, 3.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3936657111355692, "mean_inference_ms": 1.7388992940660837, "mean_action_processing_ms": 0.07818281219006337, "mean_env_wait_ms": 0.44029335396379715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 44800, "num_agent_steps_trained": 44800, "num_env_steps_sampled": 22400, "num_env_steps_trained": 22400, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 22400, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 44800, "timers": {"training_iteration_time_ms": 1084.965, "learn_time_ms": 15.489, "learn_throughput": 51649.935, "synch_weights_time_ms": 2.151}, "counters": {"num_env_steps_sampled": 22400, "num_env_steps_trained": 22400, "num_agent_steps_sampled": 44800, "num_agent_steps_trained": 44800}, "done": false, "episodes_total": 56, "training_iteration": 28, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-03-28", "timestamp": 1733745808, "time_this_iter_s": 1.083876609802246, "time_total_s": 33.8100688457489, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 33.8100688457489, "timesteps_since_restore": 0, "iterations_since_restore": 28, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 29.95, "ram_util_percent": 75.95}}
{"custom_metrics": {"sparse_reward_mean": 0.3448275862068966, "sparse_reward_min": 0, "sparse_reward_max": 20, "shaped_reward_mean": 8.551724137931034, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.896551724137931, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.362068965517241, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.603448275862069, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.0344827586206895, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.3793103448275863, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 3.8275862068965516, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.0344827586206897, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.1206896551724137, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 0.9137931034482759, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.9310344827586207, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.9310344827586206, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.396551724137931, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 10, "useful_dish_pickup_agent_0_mean": 0.05172413793103448, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.1206896551724138, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.3793103448275863, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.9482758620689655, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 9, "useful_dish_drop_agent_0_mean": 1.293103448275862, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.8620689655172413, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 8, "soup_pickup_agent_0_mean": 0.5, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 5, "soup_pickup_agent_1_mean": 0.25862068965517243, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.10344827586206896, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.05172413793103448, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.3275862068965517, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 5, "soup_drop_agent_1_mean": 0.10344827586206896, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 0.9137931034482759, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.9310344827586207, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9137931034482759, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.9310344827586207, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 7.450580707946131e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 7.422291673719883e-05, "policy_loss": 1.8777092918753624e-05, "vf_loss": 0.5544535517692566, "vf_explained_var": 0.001840054988861084, "kl": 2.0560740665587218e-07, "entropy": 1.7892897129058838, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 23200, "num_env_steps_trained": 23200, "num_agent_steps_sampled": 46400, "num_agent_steps_trained": 46400}, "sampler_results": {"episode_reward_max": 54.0, "episode_reward_min": 0.0, "episode_reward_mean": 9.241379310344827, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 34.0}, "policy_reward_mean": {"ppo": 4.620689655172414}, "custom_metrics": {"sparse_reward_mean": 0.3448275862068966, "sparse_reward_min": 0, "sparse_reward_max": 20, "shaped_reward_mean": 8.551724137931034, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.896551724137931, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.362068965517241, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.603448275862069, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.0344827586206895, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.3793103448275863, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 3.8275862068965516, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.0344827586206897, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.1206896551724137, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 0.9137931034482759, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.9310344827586207, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.9310344827586206, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.396551724137931, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 10, "useful_dish_pickup_agent_0_mean": 0.05172413793103448, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.1206896551724138, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.3793103448275863, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.9482758620689655, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 9, "useful_dish_drop_agent_0_mean": 1.293103448275862, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.8620689655172413, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 8, "soup_pickup_agent_0_mean": 0.5, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 5, "soup_pickup_agent_1_mean": 0.25862068965517243, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.10344827586206896, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.05172413793103448, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.3275862068965517, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 5, "soup_drop_agent_1_mean": 0.10344827586206896, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 0.9137931034482759, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.9310344827586207, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9137931034482759, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.9310344827586207, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0, 14.0, 11.0, 9.0, 54.0, 3.0, 6.0, 6.0, 14.0, 3.0, 3.0, 3.0, 14.0, 11.0, 9.0, 6.0, 11.0, 8.0, 9.0, 3.0, 9.0, 8.0, 19.0, 3.0, 0.0, 6.0, 8.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0, 11.0, 3.0, 8.0, 3.0, 6.0, 3.0, 34.0, 20.0, 0.0, 3.0, 0.0, 6.0, 0.0, 6.0, 6.0, 8.0, 3.0, 0.0, 3.0, 0.0, 0.0, 3.0, 8.0, 6.0, 3.0, 8.0, 0.0, 9.0, 3.0, 3.0, 8.0, 3.0, 0.0, 8.0, 0.0, 9.0, 0.0, 3.0, 3.0, 6.0, 5.0, 3.0, 6.0, 13.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 8.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39341141422063763, "mean_inference_ms": 1.7383675826690446, "mean_action_processing_ms": 0.0780147715486902, "mean_env_wait_ms": 0.44062907872145424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 54.0, "episode_reward_min": 0.0, "episode_reward_mean": 9.241379310344827, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 34.0}, "policy_reward_mean": {"ppo": 4.620689655172414}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0, 14.0, 11.0, 9.0, 54.0, 3.0, 6.0, 6.0, 14.0, 3.0, 3.0, 3.0, 14.0, 11.0, 9.0, 6.0, 11.0, 8.0, 9.0, 3.0, 9.0, 8.0, 19.0, 3.0, 0.0, 6.0, 8.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0, 11.0, 3.0, 8.0, 3.0, 6.0, 3.0, 34.0, 20.0, 0.0, 3.0, 0.0, 6.0, 0.0, 6.0, 6.0, 8.0, 3.0, 0.0, 3.0, 0.0, 0.0, 3.0, 8.0, 6.0, 3.0, 8.0, 0.0, 9.0, 3.0, 3.0, 8.0, 3.0, 0.0, 8.0, 0.0, 9.0, 0.0, 3.0, 3.0, 6.0, 5.0, 3.0, 6.0, 13.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 8.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39341141422063763, "mean_inference_ms": 1.7383675826690446, "mean_action_processing_ms": 0.0780147715486902, "mean_env_wait_ms": 0.44062907872145424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 46400, "num_agent_steps_trained": 46400, "num_env_steps_sampled": 23200, "num_env_steps_trained": 23200, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 23200, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 46400, "timers": {"training_iteration_time_ms": 1077.903, "learn_time_ms": 15.268, "learn_throughput": 52396.134, "synch_weights_time_ms": 2.151}, "counters": {"num_env_steps_sampled": 23200, "num_env_steps_trained": 23200, "num_agent_steps_sampled": 46400, "num_agent_steps_trained": 46400}, "done": false, "episodes_total": 58, "training_iteration": 29, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-03-29", "timestamp": 1733745809, "time_this_iter_s": 1.0747363567352295, "time_total_s": 34.88480520248413, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 34.88480520248413, "timesteps_since_restore": 0, "iterations_since_restore": 29, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 32.1, "ram_util_percent": 75.9}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.3333333333333333, "sparse_reward_min": 0, "sparse_reward_max": 20, "shaped_reward_mean": 8.316666666666666, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.066666666666666, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.35, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.816666666666667, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.066666666666666, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.566666666666667, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 10, "onion_drop_agent_1_mean": 3.85, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.0833333333333333, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 0.9, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.9, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.9166666666666665, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.35, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 10, "useful_dish_pickup_agent_0_mean": 0.05, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.11666666666666667, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.3833333333333333, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.9, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 9, "useful_dish_drop_agent_0_mean": 1.3166666666666667, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.8333333333333334, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 8, "soup_pickup_agent_0_mean": 0.48333333333333334, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 5, "soup_pickup_agent_1_mean": 0.25, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.1, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.05, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.31666666666666665, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 5, "soup_drop_agent_1_mean": 0.1, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 0.9, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.9, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.9, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 3.7252903539730653e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 9.907875210046768e-06, "policy_loss": -4.423782229423523e-08, "vf_loss": 0.09950992465019226, "vf_explained_var": -0.011481702327728271, "kl": 9.088820718261559e-08, "entropy": 1.7894618511199951, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 54.0, "episode_reward_min": 0.0, "episode_reward_mean": 8.983333333333333, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 34.0}, "policy_reward_mean": {"ppo": 4.491666666666666}, "custom_metrics": {"sparse_reward_mean": 0.3333333333333333, "sparse_reward_min": 0, "sparse_reward_max": 20, "shaped_reward_mean": 8.316666666666666, "shaped_reward_min": 0, "shaped_reward_max": 25, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.066666666666666, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.35, "onion_pickup_agent_1_min": 0, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.816666666666667, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 10, "useful_onion_pickup_agent_1_mean": 4.066666666666666, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 10, "onion_drop_agent_0_mean": 3.566666666666667, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 10, "onion_drop_agent_1_mean": 3.85, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 10, "useful_onion_drop_agent_0_mean": 1.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 1.0833333333333333, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 7, "potting_onion_agent_0_mean": 0.9, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.9, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.9166666666666665, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 8, "dish_pickup_agent_1_mean": 2.35, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 10, "useful_dish_pickup_agent_0_mean": 0.05, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.11666666666666667, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 2.3833333333333333, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 7, "dish_drop_agent_1_mean": 1.9, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 9, "useful_dish_drop_agent_0_mean": 1.3166666666666667, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.8333333333333334, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 8, "soup_pickup_agent_0_mean": 0.48333333333333334, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 5, "soup_pickup_agent_1_mean": 0.25, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.1, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.05, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.31666666666666665, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 5, "soup_drop_agent_1_mean": 0.1, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 0.9, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.9, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.9, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0, 14.0, 11.0, 9.0, 54.0, 3.0, 6.0, 6.0, 14.0, 3.0, 3.0, 3.0, 14.0, 11.0, 9.0, 6.0, 11.0, 8.0, 9.0, 3.0, 9.0, 8.0, 19.0, 3.0, 0.0, 6.0, 8.0, 0.0, 3.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0, 11.0, 3.0, 8.0, 3.0, 6.0, 3.0, 34.0, 20.0, 0.0, 3.0, 0.0, 6.0, 0.0, 6.0, 6.0, 8.0, 3.0, 0.0, 3.0, 0.0, 0.0, 3.0, 8.0, 6.0, 3.0, 8.0, 0.0, 9.0, 3.0, 3.0, 8.0, 3.0, 0.0, 8.0, 0.0, 9.0, 0.0, 3.0, 3.0, 6.0, 5.0, 3.0, 6.0, 13.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 8.0, 0.0, 0.0, 0.0, 3.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39315270565504984, "mean_inference_ms": 1.7379355131418115, "mean_action_processing_ms": 0.07784150287565914, "mean_env_wait_ms": 0.44089542086157446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 54.0, "episode_reward_min": 0.0, "episode_reward_mean": 8.983333333333333, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 34.0}, "policy_reward_mean": {"ppo": 4.491666666666666}, "hist_stats": {"episode_reward": [17.0, 6.0, 8.0, 8.0, 11.0, 3.0, 22.0, 9.0, 11.0, 6.0, 6.0, 3.0, 6.0, 11.0, 6.0, 3.0, 11.0, 6.0, 22.0, 9.0, 25.0, 6.0, 11.0, 3.0, 11.0, 11.0, 0.0, 0.0, 6.0, 6.0, 20.0, 3.0, 14.0, 11.0, 9.0, 54.0, 3.0, 6.0, 6.0, 14.0, 3.0, 3.0, 3.0, 14.0, 11.0, 9.0, 6.0, 11.0, 8.0, 9.0, 3.0, 9.0, 8.0, 19.0, 3.0, 0.0, 6.0, 8.0, 0.0, 3.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [11.0, 6.0, 6.0, 0.0, 0.0, 8.0, 5.0, 3.0, 6.0, 5.0, 0.0, 3.0, 19.0, 3.0, 0.0, 9.0, 11.0, 0.0, 3.0, 3.0, 3.0, 3.0, 0.0, 3.0, 3.0, 3.0, 3.0, 8.0, 6.0, 0.0, 3.0, 0.0, 5.0, 6.0, 3.0, 3.0, 5.0, 17.0, 6.0, 3.0, 11.0, 14.0, 6.0, 0.0, 0.0, 11.0, 3.0, 0.0, 3.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 3.0, 3.0, 9.0, 11.0, 0.0, 3.0, 11.0, 3.0, 8.0, 3.0, 6.0, 3.0, 34.0, 20.0, 0.0, 3.0, 0.0, 6.0, 0.0, 6.0, 6.0, 8.0, 3.0, 0.0, 3.0, 0.0, 0.0, 3.0, 8.0, 6.0, 3.0, 8.0, 0.0, 9.0, 3.0, 3.0, 8.0, 3.0, 0.0, 8.0, 0.0, 9.0, 0.0, 3.0, 3.0, 6.0, 5.0, 3.0, 6.0, 13.0, 3.0, 0.0, 0.0, 0.0, 3.0, 3.0, 8.0, 0.0, 0.0, 0.0, 3.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39315270565504984, "mean_inference_ms": 1.7379355131418115, "mean_action_processing_ms": 0.07784150287565914, "mean_env_wait_ms": 0.44089542086157446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 24000, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 1081.421, "learn_time_ms": 15.707, "learn_throughput": 50933.968, "synch_weights_time_ms": 1.851}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 60, "training_iteration": 30, "trial_id": "default", "experiment_id": "d89a5fa2d03d42548ea8cba64d4427d3", "date": "2024-12-09_23-03-32", "timestamp": 1733745812, "time_this_iter_s": 2.4947030544281006, "time_total_s": 37.37950825691223, "pid": 9680, "hostname": "HOME-BRYAN", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": false, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000153CA991308>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x00000152187A7648>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x000001521D813D38>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x000001521D813DC8>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 37.37950825691223, "timesteps_since_restore": 0, "iterations_since_restore": 30, "warmup_time": 10.6683828830719, "perf": {"cpu_util_percent": 25.975, "ram_util_percent": 75.92500000000001}}
